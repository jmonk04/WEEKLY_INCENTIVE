<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NTAG Southwest Weekly Incentive Report - Viewer</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@600;700&family=Inter:wght@400;500;600&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Helvetica, Arial, sans-serif, sans-serif;
            background: linear-gradient(135deg, #1a237e 0%, #0d47a1 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #003087 0%, #004a9e 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 42px;
            margin-bottom: 12px;
            font-weight: 700;
        }
        
        .header p {
            font-size: 29px;
            opacity: 0.95;
        }
        
        .badge {
            display: inline-block;
            background: linear-gradient(135deg, #FFB81C 0%, #FFA500 100%);
            color: #003087;
            padding: 8px 20px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 29px;
            margin-top: 15px;
        }
        
        .content {
            padding: 50px;
        }
        
        .step {
            margin-bottom: 35px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid #003087;
        }
        
        .step-number {
            display: inline-block;
            background: linear-gradient(135deg, #003087 0%, #0056b3 100%);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            text-align: center;
            line-height: 36px;
            font-weight: 700;
            margin-right: 12px;
        }
        
        .step h3 {
            display: inline-block;
            color: #003087;
            margin-bottom: 12px;
            font-size: 25px;
            font-weight: 600;
        }
        
        .upload-zone {
            border: 3px dashed #003087;
            border-radius: 12px;
            padding: 50px;
            text-align: center;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .upload-zone:hover {
            background: #f0f7ff;
            border-color: #0056b3;
        }
        
        .upload-zone.dragging {
            background: #e3f2fd;
            border-color: #1976d2;
        }
        
        .file-name {
            display: none;
            margin-top: 15px;
            color: #28a745;
            font-weight: 600;
        }
        
        input[type="file"] {
            display: none;
        }
        
        .inputs-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .input-group label {
            display: block;
            color: #003087;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 18px;
        }
        
        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #d1d5db;
            border-radius: 8px;
            font-size: 25px;
            transition: border-color 0.3s ease;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #003087;
        }
        
        button {
            background: linear-gradient(135deg, #003087 0%, #0056b3 100%);
            color: white;
            border: none;
            padding: 16px 40px;
            border-radius: 10px;
            font-size: 29px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 48, 135, 0.3);
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 48, 135, 0.4);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: center;
        }
        
        .status {
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-weight: 600;
            display: none;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        #reportOutput {
            margin-top: 40px;
            text-align: center;
            display: none;
        }
        
        #reportCanvas {
            max-width: 100%;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            cursor: pointer;
        }
        
        .download-section {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }
        
        .download-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }
        
        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }
        
        /* Modal styles for station details */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal-content {
            background: #1a2332;
            border-radius: 16px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            position: relative;
        }
        
        .modal-header {
            background: linear-gradient(135deg, #003087 0%, #0056b3 100%);
            padding: 30px;
            border-radius: 16px 16px 0 0;
            position: relative;
        }
        
        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 31px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }
        
        .modal-station-name {
            font-size: 44px;
            font-weight: 700;
            color: white;
            margin-bottom: 10px;
        }
        
        .modal-tier-badge {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 29px;
            margin-right: 10px;
        }
        
        .modal-body {
            padding: 30px;
        }
        
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: #0a1929;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #2d3e50;
        }
        
        .stat-label {
            color: #8b95a5;
            font-size: 18px;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 8px;
        }
        
        .stat-value {
            color: white;
            font-size: 49px;
            font-weight: 700;
            font-family: Helvetica, Arial, sans-serif, sans-serif;
        }
        
        .stat-subtext {
            color: #8b95a5;
            font-size: 21px;
            margin-top: 5px;
        }
        
        .section-title {
            color: white;
            font-size: 31px;
            font-weight: 700;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #2d3e50;
        }
        
        .mission-area {
            background: #0a1929;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            border-left: 4px solid;
        }
        
        .mission-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .mission-name {
            color: white;
            font-size: 29px;
            font-weight: 700;
        }
        
        .mission-percent {
            font-size: 44px;
            font-weight: 700;
            font-family: Helvetica, Arial, sans-serif, sans-serif;
        }
        
        .mission-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        
        .mission-detail-item {
            color: #8b95a5;
            font-size: 21px;
        }
        
        .mission-detail-value {
            color: white;
            font-weight: 600;
            font-size: 25px;
        }
        
        .projection-timeline {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .projection-card {
            background: #0a1929;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #2d3e50;
        }
        
        .projection-day {
            color: #8b95a5;
            font-size: 29px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .projection-target {
            color: #ffd600;
            font-size: 31px;
            font-weight: 700;
            margin: 8px 0;
            font-family: Helvetica, Arial, sans-serif, sans-serif;
        }
        
        .projection-needed {
            color: white;
            font-size: 21px;
        }
        
        .tier-progression {
            background: #0a1929;
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
        }
        
        .progression-item {
            padding: 15px;
            border-left: 4px solid;
            margin-bottom: 12px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 0 8px 8px 0;
        }
        
        .progression-tier {
            color: white;
            font-weight: 700;
            font-size: 25px;
            margin-bottom: 8px;
        }
        
        .progression-requirements {
            color: #8b95a5;
            font-size: 21px;
            line-height: 1.6;
        }
        
        .progression-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 29px;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .status-current {
            background: #28a745;
            color: white;
        }
        
        .status-achievable {
            background: #ffc107;
            color: #000;
        }
        
        .status-locked {
            background: #6c757d;
            color: white;
        }
    </style>
</head>
<body>
<body>
    <div style="max-width: 1600px; margin: 0 auto; padding: 20px;">
        <div style="background: linear-gradient(135deg, #003087 0%, #004a9e 100%); color: white; padding: 30px; text-align: center; border-radius: 12px 12px 0 0; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
            <h1 style="font-size: 36px; margin-bottom: 8px;">NTAG Southwest Weekly Incentive Report</h1>
            <p style="font-size: 15px; opacity: 0.95;">Interactive Performance Dashboard</p>
        </div>
        <canvas id="reportCanvas" style="display: block; background: white; border-radius: 0 0 12px 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); cursor: pointer; width: 100%;"></canvas>
    </div>

                <div class="download-section">
                    <button class="download-btn" id="downloadBtn">‚¨áÔ∏è Download PNG</button>
                    <button class="download-btn" id="downloadPdfBtn">üìÑ Download PDF</button>
                    <button class="download-btn" id="exportDataBtn" style="background: linear-gradient(135deg, #6f42c1 0%, #5a32a3 100%);">üìã Export Data for Deployment</button>
                    <button class="download-btn" id="exportHistoricalBtn" style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);">üìÖ Export This Week for Historical</button>
                </div>
            </div>
            
            <div id="exportSection" style="display: none; margin-top: 40px; padding: 30px; background: #f8f9fa; border-radius: 12px;">
                <h3 style="color: #003087; margin-bottom: 15px;">üìã Deployment Data</h3>
                <p style="color: #6c757d; margin-bottom: 15px;">Copy this data and paste it into the viewer file (line 369, inside REPORT_DATA brackets) to deploy your report:</p>
                <textarea id="exportDataText" readonly style="width: 100%; height: 300px; font-family: 'Courier New', monospace; font-size: 12px; padding: 15px; border: 2px solid #003087; border-radius: 8px; background: white;"></textarea>
                <button id="copyDataBtn" style="margin-top: 15px; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; border: none; padding: 12px 30px; border-radius: 8px; font-size: 25px; font-weight: 700; cursor: pointer;">
                    üìã Copy to Clipboard
                </button>
                <p id="copyStatus" style="margin-top: 10px; color: #28a745; font-weight: 600; display: none;">‚úÖ Copied to clipboard!</p>
            </div>
            
            <div id="historicalExportSection" style="display: none; margin-top: 40px; padding: 30px; background: #e7f4f7; border-radius: 12px; border-left: 4px solid #17a2b8;">
                <h3 style="color: #17a2b8; margin-bottom: 15px;">üìÖ Historical Week Data</h3>
                <p style="color: #6c757d; margin-bottom: 15px;">
                    <strong>Save this for your records!</strong> This is Week <span id="weekNumber" style="font-weight: 700; color: #17a2b8;"></span> data in historical format.
                    <br>Each week, export and save this JSON. After several weeks, combine them into an array to enable trend charts.
                </p>
                <textarea id="historicalDataText" readonly style="width: 100%; height: 200px; font-family: 'Courier New', monospace; font-size: 12px; padding: 15px; border: 2px solid #17a2b8; border-radius: 8px; background: white;"></textarea>
                <button id="copyHistoricalBtn" style="margin-top: 15px; background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); color: white; border: none; padding: 12px 30px; border-radius: 8px; font-size: 25px; font-weight: 700; cursor: pointer;">
                    üìã Copy This Week's Data
                </button>
                <p id="copyHistoricalStatus" style="margin-top: 10px; color: #17a2b8; font-weight: 600; display: none;">‚úÖ Copied to clipboard!</p>
                
                <div style="margin-top: 20px; padding: 15px; background: white; border-radius: 8px; border: 1px solid #17a2b8;">
                    <h4 style="color: #17a2b8; margin-bottom: 10px;">üìù How to Build Your Historical File:</h4>
                    <ol style="color: #6c757d; font-size: 18px; line-height: 1.8;">
                        <li>Each week, copy the data above and save it in a text file (e.g., "Week1_07OCT25.json")</li>
                        <li>After collecting several weeks, combine them into an array like this:</li>
                    </ol>
                    <pre style="background: #f8f9fa; padding: 10px; border-radius: 4px; font-size: 11px; overflow-x: auto; margin-top: 10px;">
[
  { "week": 1, "production_day": 5, "date": "07OCT25", "stations": [...] },
  { "week": 2, "production_day": 10, "date": "16OCT25", "stations": [...] },
  { "week": 3, "production_day": 15, "date": "23OCT25", "stations": [...] }
]</pre>
                    <ol start="3" style="color: #6c757d; font-size: 18px; line-height: 1.8; margin-top: 10px;">
                        <li>Paste that combined array into the "Historical Trend Data" box above</li>
                        <li>Click "Load Historical Data" and generate your report with trend lines!</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal for station details -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-close" id="modalClose">√ó</button>
                <div class="modal-station-name" id="modalStationName"></div>
                <div id="modalBadges"></div>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Content will be dynamically generated -->
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        let excelData = null;
        let previousExcelData = null;
        // ========================================
        // PASTE YOUR ENTIRE REPORT JSON HERE
        // (Copy from "Download Report Data (JSON)" button)
        // ========================================
        const REPORT_DATA_CONFIG = {
    "DIVISION": "DIV 7",
    "SIZE": "MEDIUM",
    "STATIONS": "LAS VEGAS",
    "ALNAV GOAL": 85,
    "ALNAV GROSS": 32,
    "ALNAV LOSS": 2,
    "ALNAV ATTN": 30,
    "ALNAV %": 0.35294117647058826,
    "ALNAV GLIDESLOPE %": 1.9124487004103972,
    "AC GOAL": 83,
    "AC GROSS": 30,
    "AC LOSS": 1,
    "AC ATTN": 29,
    "AC %": 0.3493975903614458,
    "AC GLIDESLOPE %": 1.893247408237602,
    "RC GOAL": 2,
    "RC GROSS": 2,
    "RC LOSS": 1,
    "RC ATTN": 1,
    "RC %": 0.5,
    "RC GLIDESLOPE %": 2.709302325581396,
    "NAT GOAL": 1,
    "NAT GROSS": 2,
    "NAT LOSS": 1,
    "NAT ATTN": 1,
    "NAT %": 1,
    "NAT GLIDESLOPE %": 5.418604651162792,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 5,
    "NUKE GROSS": 1,
    "NUKE LOSS": 0,
    "NUKE ATTN": 1,
    "NUKE %": 0.2,
    "NUKE GLIDESLOPE %": 1.0837209302325583,
    "NSO GOAL": 4,
    "NSO GROSS": 5,
    "NSO LOSS": 0,
    "NSO ATTN": 5,
    "NSO %": 1.25,
    "NSO GLIDESLOPE %": 6.77325581395349,
    "NNS GOAL": 4,
    "NNS GROSS": 1,
    "NNS LOSS": 0,
    "NNS ATTN": 1,
    "NNS %": 0.25,
    "NNS GLIDESLOPE %": 1.354651162790698,
    "AC TTCU GOAL": 53,
    "AC TTCU GROSS": 20,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 19,
    "AC TTCU %": 0.3584905660377358,
    "PRI RATE GOAL": 7,
    "PRI RATE GROSS": 6,
    "PRI RATE LOSS": 2,
    "PRI RATE ATTN": 4,
    "PRI RATE %": 0.5714285714285714,
    "TIER": "ZEUS",
    "LEVEL": 2,
    "REWARD": "Recurring 72-hour special liberty",
    "NF GLIDESLOPE %": 1.0837209302325583,
    "ALNAV_CHANGE_PCT": 0
  },
  {
    "DIVISION": "DIV 2",
    "SIZE": "SMALL",
    "STATIONS": "MIRA MESA",
    "ALNAV GOAL": 60,
    "ALNAV GROSS": 20,
    "ALNAV LOSS": 0,
    "ALNAV ATTN": 20,
    "ALNAV %": 0.3333333333333333,
    "ALNAV GLIDESLOPE %": 1.8062015503875974,
    "AC GOAL": 58,
    "AC GROSS": 20,
    "AC LOSS": 0,
    "AC ATTN": 20,
    "AC %": 0.3448275862068966,
    "AC GLIDESLOPE %": 1.8684843624699283,
    "RC GOAL": 2,
    "RC GROSS": 0,
    "RC LOSS": 0,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 0,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 1,
    "TAR GOAL": 2,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 5,
    "NUKE GROSS": 0,
    "NUKE LOSS": 0,
    "NUKE ATTN": 0,
    "NUKE %": 0,
    "NUKE GLIDESLOPE %": 0,
    "NSO GOAL": 4,
    "NSO GROSS": 1,
    "NSO LOSS": 0,
    "NSO ATTN": 1,
    "NSO %": 0.25,
    "NSO GLIDESLOPE %": 1.354651162790698,
    "NNS GOAL": 3,
    "NNS GROSS": 0,
    "NNS LOSS": 0,
    "NNS ATTN": 0,
    "NNS %": 0,
    "NNS GLIDESLOPE %": 0,
    "AC TTCU GOAL": 40,
    "AC TTCU GROSS": 13,
    "AC TTCU LOSS": 0,
    "AC TTCU ATTN": 13,
    "AC TTCU %": 0.325,
    "PRI RATE GOAL": 6,
    "PRI RATE GROSS": 2,
    "PRI RATE LOSS": 0,
    "PRI RATE ATTN": 2,
    "PRI RATE %": 0.3333333333333333,
    "TIER": "ZEUS",
    "LEVEL": 2,
    "REWARD": "Recurring 72-hour special liberty",
    "NF GLIDESLOPE %": 0,
    "ALNAV_CHANGE_PCT": 0.06892084863321091
  },
  {
    "DIVISION": "DIV 4",
    "SIZE": "SMALL",
    "STATIONS": "HEMET",
    "ALNAV GOAL": 74,
    "ALNAV GROSS": 24,
    "ALNAV LOSS": 3,
    "ALNAV ATTN": 21,
    "ALNAV %": 0.28378378378378377,
    "ALNAV GLIDESLOPE %": 1.537712130735387,
    "AC GOAL": 72,
    "AC GROSS": 23,
    "AC LOSS": 2,
    "AC ATTN": 21,
    "AC %": 0.2916666666666667,
    "AC GLIDESLOPE %": 1.5804263565891477,
    "RC GOAL": 2,
    "RC GROSS": 1,
    "RC LOSS": 1,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 1,
    "NAT ATTN": -1,
    "NAT %": -1,
    "NAT GLIDESLOPE %": -5.418604651162792,
    "TAR GOAL": 1,
    "TAR GROSS": 1,
    "TAR LOSS": 0,
    "TAR ATTN": 1,
    "TAR %": 1,
    "TAR GLIDESLOPE %": 5.418604651162792,
    "NUKE GOAL": 5,
    "NUKE GROSS": 1,
    "NUKE LOSS": 0,
    "NUKE ATTN": 1,
    "NUKE %": 0.2,
    "NUKE GLIDESLOPE %": 1.0837209302325583,
    "NSO GOAL": 3,
    "NSO GROSS": 1,
    "NSO LOSS": 0,
    "NSO ATTN": 1,
    "NSO %": 0.3333333333333333,
    "NSO GLIDESLOPE %": 1.8062015503875974,
    "NNS GOAL": 5,
    "NNS GROSS": 3,
    "NNS LOSS": 3,
    "NNS ATTN": 0,
    "NNS %": 0,
    "NNS GLIDESLOPE %": 0,
    "AC TTCU GOAL": 41,
    "AC TTCU GROSS": 13,
    "AC TTCU LOSS": 0,
    "AC TTCU ATTN": 13,
    "AC TTCU %": 0.3170731707317073,
    "PRI RATE GOAL": 6,
    "PRI RATE GROSS": 4,
    "PRI RATE LOSS": 0,
    "PRI RATE ATTN": 4,
    "PRI RATE %": 0.6666666666666666,
    "TIER": "ZEUS",
    "LEVEL": 2,
    "REWARD": "Recurring 72-hour special liberty",
    "NF GLIDESLOPE %": 1.0837209302325583,
    "ALNAV_CHANGE_PCT": -0.202330543517814
  },
  {
    "DIVISION": "DIV 2",
    "SIZE": "MEDIUM",
    "STATIONS": "ESCONDIDO",
    "ALNAV GOAL": 77,
    "ALNAV GROSS": 22,
    "ALNAV LOSS": 1,
    "ALNAV ATTN": 21,
    "ALNAV %": 0.2727272727272727,
    "ALNAV GLIDESLOPE %": 1.4778012684989432,
    "AC GOAL": 76,
    "AC GROSS": 21,
    "AC LOSS": 1,
    "AC ATTN": 20,
    "AC %": 0.2631578947368421,
    "AC GLIDESLOPE %": 1.4259485924112612,
    "RC GOAL": 1,
    "RC GROSS": 1,
    "RC LOSS": 0,
    "RC ATTN": 1,
    "RC %": 1,
    "RC GLIDESLOPE %": 5.418604651162792,
    "NAT GOAL": 1,
    "NAT GROSS": 1,
    "NAT LOSS": 0,
    "NAT ATTN": 1,
    "NAT %": 1,
    "NAT GLIDESLOPE %": 5.418604651162792,
    "TAR GOAL": 0,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 1,
    "NUKE GOAL": 5,
    "NUKE GROSS": 0,
    "NUKE LOSS": 0,
    "NUKE ATTN": 0,
    "NUKE %": 0,
    "NUKE GLIDESLOPE %": 0,
    "NSO GOAL": 4,
    "NSO GROSS": 1,
    "NSO LOSS": 1,
    "NSO ATTN": 0,
    "NSO %": 0,
    "NSO GLIDESLOPE %": 0,
    "NNS GOAL": 5,
    "NNS GROSS": 3,
    "NNS LOSS": 0,
    "NNS ATTN": 3,
    "NNS %": 0.6,
    "NNS GLIDESLOPE %": 3.251162790697675,
    "AC TTCU GOAL": 44,
    "AC TTCU GROSS": 11,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 10,
    "AC TTCU %": 0.22727272727272727,
    "PRI RATE GOAL": 8,
    "PRI RATE GROSS": 5,
    "PRI RATE LOSS": 0,
    "PRI RATE ATTN": 5,
    "PRI RATE %": 0.625,
    "TIER": "ZEUS",
    "LEVEL": 1,
    "REWARD": "96-hour special liberty (one time per quarter)",
    "NF GLIDESLOPE %": 0,
    "ALNAV_CHANGE_PCT": 0.04444515093229895
  },
  {
    "DIVISION": "DIV 1 ",
    "SIZE": "MEDIUM",
    "STATIONS": "COLLEGE GROVE",
    "ALNAV GOAL": 76,
    "ALNAV GROSS": 21,
    "ALNAV LOSS": 1,
    "ALNAV ATTN": 20,
    "ALNAV %": 0.2631578947368421,
    "ALNAV GLIDESLOPE %": 1.4259485924112612,
    "AC GOAL": 74,
    "AC GROSS": 21,
    "AC LOSS": 1,
    "AC ATTN": 20,
    "AC %": 0.2702702702702703,
    "AC GLIDESLOPE %": 1.4644877435575114,
    "RC GOAL": 2,
    "RC GROSS": 0,
    "RC LOSS": 0,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 11,
    "NUKE GROSS": 1,
    "NUKE LOSS": 0,
    "NUKE ATTN": 1,
    "NUKE %": 0.09090909090909091,
    "NUKE GLIDESLOPE %": 0.4926004228329811,
    "NSO GOAL": 5,
    "NSO GROSS": 4,
    "NSO LOSS": 0,
    "NSO ATTN": 4,
    "NSO %": 0.8,
    "NSO GLIDESLOPE %": 4.334883720930233,
    "NNS GOAL": 9,
    "NNS GROSS": 1,
    "NNS LOSS": 0,
    "NNS ATTN": 1,
    "NNS %": 0.1111111111111111,
    "NNS GLIDESLOPE %": 0.6020671834625324,
    "AC TTCU GOAL": 47,
    "AC TTCU GROSS": 14,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 13,
    "AC TTCU %": 0.2765957446808511,
    "PRI RATE GOAL": 8,
    "PRI RATE GROSS": 5,
    "PRI RATE LOSS": 2,
    "PRI RATE ATTN": 3,
    "PRI RATE %": 0.375,
    "TIER": "ZEUS",
    "LEVEL": 2,
    "REWARD": "Recurring 72-hour special liberty",
    "NF GLIDESLOPE %": 0.4926004228329811,
    "ALNAV_CHANGE_PCT": 0.054411196289377184
  },
  {
    "DIVISION": "DIV 6",
    "SIZE": "MEGA",
    "STATIONS": "VICTORVILLE",
    "ALNAV GOAL": 122,
    "ALNAV GROSS": 35,
    "ALNAV LOSS": 3,
    "ALNAV ATTN": 32,
    "ALNAV %": 0.26229508196721313,
    "ALNAV GLIDESLOPE %": 1.4212733511246667,
    "AC GOAL": 120,
    "AC GROSS": 34,
    "AC LOSS": 3,
    "AC ATTN": 31,
    "AC %": 0.25833333333333336,
    "AC GLIDESLOPE %": 1.399806201550388,
    "RC GOAL": 2,
    "RC GROSS": 1,
    "RC LOSS": 0,
    "RC ATTN": 1,
    "RC %": 0.5,
    "RC GLIDESLOPE %": 2.709302325581396,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 1,
    "TAR GROSS": 1,
    "TAR LOSS": 0,
    "TAR ATTN": 1,
    "TAR %": 1,
    "TAR GLIDESLOPE %": 5.418604651162792,
    "NUKE GOAL": 8,
    "NUKE GROSS": 2,
    "NUKE LOSS": 0,
    "NUKE ATTN": 2,
    "NUKE %": 0.25,
    "NUKE GLIDESLOPE %": 1.354651162790698,
    "NSO GOAL": 5,
    "NSO GROSS": 2,
    "NSO LOSS": 0,
    "NSO ATTN": 2,
    "NSO %": 0.4,
    "NSO GLIDESLOPE %": 2.1674418604651167,
    "NNS GOAL": 6,
    "NNS GROSS": 2,
    "NNS LOSS": 1,
    "NNS ATTN": 1,
    "NNS %": 0.16666666666666666,
    "NNS GLIDESLOPE %": 0.9031007751937987,
    "AC TTCU GOAL": 57,
    "AC TTCU GROSS": 21,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 20,
    "AC TTCU %": 0.3508771929824561,
    "PRI RATE GOAL": 10,
    "PRI RATE GROSS": 7,
    "PRI RATE LOSS": 1,
    "PRI RATE ATTN": 6,
    "PRI RATE %": 0.6,
    "TIER": "ZEUS",
    "LEVEL": 2,
    "REWARD": "Recurring 72-hour special liberty",
    "NF GLIDESLOPE %": 1.354651162790698,
    "ALNAV_CHANGE_PCT": 0.014025723859782957
  },
  {
    "DIVISION": "DIV 1 ",
    "SIZE": "MEGA",
    "STATIONS": "CHULA VISTA",
    "ALNAV GOAL": 144,
    "ALNAV GROSS": 37,
    "ALNAV LOSS": 1,
    "ALNAV ATTN": 36,
    "ALNAV %": 0.25,
    "ALNAV GLIDESLOPE %": 1.354651162790698,
    "AC GOAL": 140,
    "AC GROSS": 36,
    "AC LOSS": 1,
    "AC ATTN": 35,
    "AC %": 0.25,
    "AC GLIDESLOPE %": 1.354651162790698,
    "RC GOAL": 4,
    "RC GROSS": 1,
    "RC LOSS": 0,
    "RC ATTN": 1,
    "RC %": 0.25,
    "RC GLIDESLOPE %": 1.354651162790698,
    "NAT GOAL": 2,
    "NAT GROSS": 1,
    "NAT LOSS": 0,
    "NAT ATTN": 1,
    "NAT %": 0.5,
    "NAT GLIDESLOPE %": 0.09227467811158796,
    "TAR GOAL": 2,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 11,
    "NUKE GROSS": 0,
    "NUKE LOSS": 0,
    "NUKE ATTN": 0,
    "NUKE %": 0,
    "NUKE GLIDESLOPE %": 0,
    "NSO GOAL": 7,
    "NSO GROSS": 3,
    "NSO LOSS": 0,
    "NSO ATTN": 3,
    "NSO %": 0.42857142857142855,
    "NSO GLIDESLOPE %": 2.322259136212625,
    "NNS GOAL": 9,
    "NNS GROSS": 3,
    "NNS LOSS": 2,
    "NNS ATTN": 1,
    "NNS %": 0.1111111111111111,
    "NNS GLIDESLOPE %": 0.6020671834625324,
    "AC TTCU GOAL": 88,
    "AC TTCU GROSS": 32,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 31,
    "AC TTCU %": 0.3522727272727273,
    "PRI RATE GOAL": 16,
    "PRI RATE GROSS": 6,
    "PRI RATE LOSS": 2,
    "PRI RATE ATTN": 4,
    "PRI RATE %": 0.25,
    "TIER": "POSEIDON",
    "LEVEL": 1,
    "REWARD": "96-hour special liberty (one time per quarter)",
    "NF GLIDESLOPE %": 0,
    "ALNAV_CHANGE_PCT": -0.09308275533795718
  },
  {
    "DIVISION": "DIV 6",
    "SIZE": "LARGE",
    "STATIONS": "SAN BERNARDINO",
    "ALNAV GOAL": 96,
    "ALNAV GROSS": 26,
    "ALNAV LOSS": 3,
    "ALNAV ATTN": 23,
    "ALNAV %": 0.23958333333333334,
    "ALNAV GLIDESLOPE %": 1.2982073643410856,
    "AC GOAL": 94,
    "AC GROSS": 25,
    "AC LOSS": 2,
    "AC ATTN": 23,
    "AC %": 0.24468085106382978,
    "AC GLIDESLOPE %": 1.3258287976249385,
    "RC GOAL": 2,
    "RC GROSS": 1,
    "RC LOSS": 1,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 1,
    "NAT GROSS": 1,
    "NAT LOSS": 0,
    "NAT ATTN": 1,
    "NAT %": 1,
    "NAT GLIDESLOPE %": 5.418604651162792,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 1,
    "TAR ATTN": -1,
    "TAR %": -1,
    "TAR GLIDESLOPE %": -5.418604651162792,
    "NUKE GOAL": 7,
    "NUKE GROSS": 2,
    "NUKE LOSS": 1,
    "NUKE ATTN": 1,
    "NUKE %": 0.14285714285714285,
    "NUKE GLIDESLOPE %": 0.7740863787375417,
    "NSO GOAL": 5,
    "NSO GROSS": 1,
    "NSO LOSS": 0,
    "NSO ATTN": 1,
    "NSO %": 0.2,
    "NSO GLIDESLOPE %": 1.0837209302325583,
    "NNS GOAL": 6,
    "NNS GROSS": 4,
    "NNS LOSS": 0,
    "NNS ATTN": 4,
    "NNS %": 0.6666666666666666,
    "NNS GLIDESLOPE %": 3.612403100775195,
    "AC TTCU GOAL": 55,
    "AC TTCU GROSS": 12,
    "AC TTCU LOSS": 2,
    "AC TTCU ATTN": 10,
    "AC TTCU %": 0.18181818181818182,
    "PRI RATE GOAL": 9,
    "PRI RATE GROSS": 5,
    "PRI RATE LOSS": 2,
    "PRI RATE ATTN": 3,
    "PRI RATE %": 0.3333333333333333,
    "TIER": "POSEIDON",
    "LEVEL": 1,
    "REWARD": "96-hour special liberty (one time per quarter)",
    "NF GLIDESLOPE %": 0.7740863787375417,
    "ALNAV_CHANGE_PCT": 0
  },
  {
    "DIVISION": "DIV 5",
    "SIZE": "LARGE",
    "STATIONS": "RIVERSIDE",
    "ALNAV GOAL": 101,
    "ALNAV GROSS": 26,
    "ALNAV LOSS": 2,
    "ALNAV ATTN": 24,
    "ALNAV %": 0.2376237623762376,
    "ALNAV GLIDESLOPE %": 1.2875892240386833,
    "AC GOAL": 99,
    "AC GROSS": 25,
    "AC LOSS": 1,
    "AC ATTN": 24,
    "AC %": 0.24242424242424243,
    "AC GLIDESLOPE %": 1.3136011275546162,
    "RC GOAL": 2,
    "RC GROSS": 1,
    "RC LOSS": 1,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 1,
    "NAT ATTN": -1,
    "NAT %": -1,
    "NAT GLIDESLOPE %": -5.418604651162792,
    "TAR GOAL": 1,
    "TAR GROSS": 1,
    "TAR LOSS": 0,
    "TAR ATTN": 1,
    "TAR %": 1,
    "TAR GLIDESLOPE %": 5.418604651162792,
    "NUKE GOAL": 7,
    "NUKE GROSS": 2,
    "NUKE LOSS": 0,
    "NUKE ATTN": 2,
    "NUKE %": 0.2857142857142857,
    "NUKE GLIDESLOPE %": 1.5481727574750834,
    "NSO GOAL": 5,
    "NSO GROSS": 0,
    "NSO LOSS": 0,
    "NSO ATTN": 0,
    "NSO %": 0,
    "NSO GLIDESLOPE %": 0,
    "NNS GOAL": 6,
    "NNS GROSS": 1,
    "NNS LOSS": 0,
    "NNS ATTN": 1,
    "NNS %": 0.16666666666666666,
    "NNS GLIDESLOPE %": 0.9031007751937987,
    "AC TTCU GOAL": 52,
    "AC TTCU GROSS": 15,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 14,
    "AC TTCU %": 0.2692307692307692,
    "PRI RATE GOAL": 9,
    "PRI RATE GROSS": 5,
    "PRI RATE LOSS": 1,
    "PRI RATE ATTN": 4,
    "PRI RATE %": 0.4444444444444444,
    "TIER": "POSEIDON",
    "LEVEL": 1,
    "REWARD": "96-hour special liberty (one time per quarter)",
    "NF GLIDESLOPE %": 1.5481727574750834,
    "ALNAV_CHANGE_PCT": -0.10871093229273954
  },
  {
    "DIVISION": "DIV 2",
    "SIZE": "LARGE",
    "STATIONS": "CLAIREMONT",
    "ALNAV GOAL": 94,
    "ALNAV GROSS": 27,
    "ALNAV LOSS": 5,
    "ALNAV ATTN": 22,
    "ALNAV %": 0.23404255319148937,
    "ALNAV GLIDESLOPE %": 1.2681840672934195,
    "AC GOAL": 92,
    "AC GROSS": 25,
    "AC LOSS": 5,
    "AC ATTN": 20,
    "AC %": 0.21739130434782608,
    "AC GLIDESLOPE %": 1.1779575328614764,
    "RC GOAL": 2,
    "RC GROSS": 2,
    "RC LOSS": 0,
    "RC ATTN": 2,
    "RC %": 1,
    "RC GLIDESLOPE %": 5.418604651162792,
    "NAT GOAL": 1,
    "NAT GROSS": 1,
    "NAT LOSS": 0,
    "NAT ATTN": 1,
    "NAT %": 1,
    "NAT GLIDESLOPE %": 5.418604651162792,
    "TAR GOAL": 1,
    "TAR GROSS": 1,
    "TAR LOSS": 0,
    "TAR ATTN": 1,
    "TAR %": 1,
    "TAR GLIDESLOPE %": 5.418604651162792,
    "NUKE GOAL": 5,
    "NUKE GROSS": 1,
    "NUKE LOSS": 0,
    "NUKE ATTN": 1,
    "NUKE %": 0.2,
    "NUKE GLIDESLOPE %": 1.0837209302325583,
    "NSO GOAL": 6,
    "NSO GROSS": 3,
    "NSO LOSS": 2,
    "NSO ATTN": 1,
    "NSO %": 0.16666666666666666,
    "NSO GLIDESLOPE %": 0.9031007751937987,
    "NNS GOAL": 5,
    "NNS GROSS": 0,
    "NNS LOSS": 0,
    "NNS ATTN": 0,
    "NNS %": 0,
    "NNS GLIDESLOPE %": 0,
    "AC TTCU GOAL": 55,
    "AC TTCU GROSS": 10,
    "AC TTCU LOSS": 3,
    "AC TTCU ATTN": 7,
    "AC TTCU %": 0.12727272727272726,
    "PRI RATE GOAL": 10,
    "PRI RATE GROSS": 5,
    "PRI RATE LOSS": 1,
    "PRI RATE ATTN": 4,
    "PRI RATE %": 0.4,
    "TIER": "POSEIDON",
    "LEVEL": 1,
    "REWARD": "96-hour special liberty (one time per quarter)",
    "NF GLIDESLOPE %": 1.0837209302325583,
    "ALNAV_CHANGE_PCT": -0.16686632464387086
  },
  {
    "DIVISION": "DIV 4",
    "SIZE": "MEDIUM",
    "STATIONS": "SUN CITY",
    "ALNAV GOAL": 77,
    "ALNAV GROSS": 21,
    "ALNAV LOSS": 4,
    "ALNAV ATTN": 17,
    "ALNAV %": 0.22077922077922077,
    "ALNAV GLIDESLOPE %": 1.1963153125943826,
    "AC GOAL": 75,
    "AC GROSS": 21,
    "AC LOSS": 2,
    "AC ATTN": 19,
    "AC %": 0.25333333333333335,
    "AC GLIDESLOPE %": 1.372713178294574,
    "RC GOAL": 2,
    "RC GROSS": 0,
    "RC LOSS": 2,
    "RC ATTN": -2,
    "RC %": -1,
    "RC GLIDESLOPE %": -5.418604651162792,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 2,
    "TAR ATTN": -2,
    "TAR %": -2,
    "TAR GLIDESLOPE %": -10.837209302325585,
    "NUKE GOAL": 6,
    "NUKE GROSS": 2,
    "NUKE LOSS": 0,
    "NUKE ATTN": 2,
    "NUKE %": 0.3333333333333333,
    "NUKE GLIDESLOPE %": 1.8062015503875974,
    "NSO GOAL": 4,
    "NSO GROSS": 0,
    "NSO LOSS": 0,
    "NSO ATTN": 0,
    "NSO %": 0,
    "NSO GLIDESLOPE %": 0,
    "NNS GOAL": 6,
    "NNS GROSS": 4,
    "NNS LOSS": 1,
    "NNS ATTN": 3,
    "NNS %": 0.5,
    "NNS GLIDESLOPE %": 2.709302325581396,
    "AC TTCU GOAL": 49,
    "AC TTCU GROSS": 10,
    "AC TTCU LOSS": 2,
    "AC TTCU ATTN": 8,
    "AC TTCU %": 0.16326530612244897,
    "PRI RATE GOAL": 7,
    "PRI RATE GROSS": 5,
    "PRI RATE LOSS": 0,
    "PRI RATE ATTN": 5,
    "PRI RATE %": 0.7142857142857143,
    "TIER": "TRITON",
    "LEVEL": 1,
    "REWARD": "Polo Mondays",
    "NF GLIDESLOPE %": 1.8062015503875974,
    "ALNAV_CHANGE_PCT": -0.15740990955189238
  },
  {
    "DIVISION": "DIV 5",
    "SIZE": "LARGE",
    "STATIONS": "UPLAND",
    "ALNAV GOAL": 95,
    "ALNAV GROSS": 23,
    "ALNAV LOSS": 3,
    "ALNAV ATTN": 20,
    "ALNAV %": 0.21052631578947367,
    "ALNAV GLIDESLOPE %": 1.1407588739290089,
    "AC GOAL": 93,
    "AC GROSS": 23,
    "AC LOSS": 2,
    "AC ATTN": 21,
    "AC %": 0.22580645161290322,
    "AC GLIDESLOPE %": 1.2235558889722433,
    "RC GOAL": 2,
    "RC GROSS": 0,
    "RC LOSS": 1,
    "RC ATTN": -1,
    "RC %": -0.5,
    "RC GLIDESLOPE %": -2.709302325581396,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 1,
    "NAT ATTN": -1,
    "NAT %": -1,
    "NAT GLIDESLOPE %": -5.418604651162792,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 6,
    "NUKE GROSS": 0,
    "NUKE LOSS": 0,
    "NUKE ATTN": 0,
    "NUKE %": 0,
    "NUKE GLIDESLOPE %": 0,
    "NSO GOAL": 5,
    "NSO GROSS": 2,
    "NSO LOSS": 1,
    "NSO ATTN": 1,
    "NSO %": 0.2,
    "NSO GLIDESLOPE %": 1.0837209302325583,
    "NNS GOAL": 6,
    "NNS GROSS": 4,
    "NNS LOSS": 1,
    "NNS ATTN": 3,
    "NNS %": 0.5,
    "NNS GLIDESLOPE %": 2.709302325581396,
    "AC TTCU GOAL": 52,
    "AC TTCU GROSS": 18,
    "AC TTCU LOSS": 2,
    "AC TTCU ATTN": 16,
    "AC TTCU %": 0.3076923076923077,
    "PRI RATE GOAL": 9,
    "PRI RATE GROSS": 1,
    "PRI RATE LOSS": 0,
    "PRI RATE ATTN": 1,
    "PRI RATE %": 0.1111111111111111,
    "TIER": "TRITON",
    "LEVEL": 1,
    "REWARD": "Polo Mondays",
    "NF GLIDESLOPE %": 0,
    "ALNAV_CHANGE_PCT": -0.0855569155446756
  },
  {
    "DIVISION": "DIV 4",
    "SIZE": "MEGA",
    "STATIONS": "TEMECULA",
    "ALNAV GOAL": 168,
    "ALNAV GROSS": 38,
    "ALNAV LOSS": 3,
    "ALNAV ATTN": 35,
    "ALNAV %": 0.20833333333333334,
    "ALNAV GLIDESLOPE %": 1.1288759689922483,
    "AC GOAL": 166,
    "AC GROSS": 37,
    "AC LOSS": 3,
    "AC ATTN": 34,
    "AC %": 0.20481927710843373,
    "AC GLIDESLOPE %": 1.1098346875875598,
    "RC GOAL": 2,
    "RC GROSS": 1,
    "RC LOSS": 0,
    "RC ATTN": 1,
    "RC %": 0.5,
    "RC GLIDESLOPE %": 2.709302325581396,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 1,
    "TAR GROSS": 1,
    "TAR LOSS": 0,
    "TAR ATTN": 1,
    "TAR %": 1,
    "TAR GLIDESLOPE %": 5.418604651162792,
    "NUKE GOAL": 15,
    "NUKE GROSS": 1,
    "NUKE LOSS": 0,
    "NUKE ATTN": 1,
    "NUKE %": 0.06666666666666667,
    "NUKE GLIDESLOPE %": 0.36124031007751944,
    "NSO GOAL": 11,
    "NSO GROSS": 4,
    "NSO LOSS": 1,
    "NSO ATTN": 3,
    "NSO %": 0.2727272727272727,
    "NSO GLIDESLOPE %": 1.4778012684989432,
    "NNS GOAL": 9,
    "NNS GROSS": 3,
    "NNS LOSS": 1,
    "NNS ATTN": 2,
    "NNS %": 0.2222222222222222,
    "NNS GLIDESLOPE %": 1.2041343669250648,
    "AC TTCU GOAL": 107,
    "AC TTCU GROSS": 23,
    "AC TTCU LOSS": 3,
    "AC TTCU ATTN": 20,
    "AC TTCU %": 0.18691588785046728,
    "PRI RATE GOAL": 20,
    "PRI RATE GROSS": 8,
    "PRI RATE LOSS": 2,
    "PRI RATE ATTN": 6,
    "PRI RATE %": 0.3,
    "TIER": "TRITON",
    "LEVEL": 1,
    "REWARD": "Polo Mondays",
    "NF GLIDESLOPE %": 0.36124031007751944,
    "ALNAV_CHANGE_PCT": -0.11203881797517035
  },
  {
    "DIVISION": "DIV 7",
    "SIZE": "LARGE",
    "STATIONS": "HENDERSON",
    "ALNAV GOAL": 106,
    "ALNAV GROSS": 23,
    "ALNAV LOSS": 1,
    "ALNAV ATTN": 22,
    "ALNAV %": 0.20754716981132076,
    "ALNAV GLIDESLOPE %": 1.1246160596752965,
    "AC GOAL": 104,
    "AC GROSS": 21,
    "AC LOSS": 1,
    "AC ATTN": 20,
    "AC %": 0.19230769230769232,
    "AC GLIDESLOPE %": 1.0420393559928447,
    "RC GOAL": 2,
    "RC GROSS": 2,
    "RC LOSS": 0,
    "RC ATTN": 2,
    "RC %": 1,
    "RC GLIDESLOPE %": 5.418604651162792,
    "NAT GOAL": 1,
    "NAT GROSS": 2,
    "NAT LOSS": 0,
    "NAT ATTN": 2,
    "NAT %": 2,
    "NAT GLIDESLOPE %": 10.837209302325585,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 8,
    "NUKE GROSS": 0,
    "NUKE LOSS": 0,
    "NUKE ATTN": 0,
    "NUKE %": 0,
    "NUKE GLIDESLOPE %": 0,
    "NSO GOAL": 6,
    "NSO GROSS": 0,
    "NSO LOSS": 2,
    "NSO ATTN": -2,
    "NSO %": -0.3333333333333333,
    "NSO GLIDESLOPE %": -1.8062015503875974,
    "NNS GOAL": 8,
    "NNS GROSS": 2,
    "NNS LOSS": 1,
    "NNS ATTN": 1,
    "NNS %": 0.125,
    "NNS GLIDESLOPE %": 0.677325581395349,
    "AC TTCU GOAL": 56,
    "AC TTCU GROSS": 11,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 10,
    "AC TTCU %": 0.17857142857142858,
    "PRI RATE GOAL": 12,
    "PRI RATE GROSS": 6,
    "PRI RATE LOSS": 0,
    "PRI RATE ATTN": 6,
    "PRI RATE %": 0.5,
    "TIER": "TRITON",
    "LEVEL": 1,
    "REWARD": "Polo Mondays",
    "NF GLIDESLOPE %": 0,
    "ALNAV_CHANGE_PCT": -0.03228562850742467
  },
  {
    "DIVISION": "DIV 4",
    "SIZE": "SMALL",
    "STATIONS": "PALM DESERT",
    "ALNAV GOAL": 80,
    "ALNAV GROSS": 17,
    "ALNAV LOSS": 1,
    "ALNAV ATTN": 16,
    "ALNAV %": 0.2,
    "ALNAV GLIDESLOPE %": 1.0837209302325583,
    "AC GOAL": 78,
    "AC GROSS": 17,
    "AC LOSS": 1,
    "AC ATTN": 16,
    "AC %": 0.20512820512820512,
    "AC GLIDESLOPE %": 1.1115086463923676,
    "RC GOAL": 2,
    "RC GROSS": 0,
    "RC LOSS": 0,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 5,
    "NUKE GROSS": 4,
    "NUKE LOSS": 0,
    "NUKE ATTN": 4,
    "NUKE %": 0.8,
    "NUKE GLIDESLOPE %": 4.334883720930233,
    "NSO GOAL": 4,
    "NSO GROSS": 0,
    "NSO LOSS": 0,
    "NSO ATTN": 0,
    "NSO %": 0,
    "NSO GLIDESLOPE %": 0,
    "NNS GOAL": 6,
    "NNS GROSS": 0,
    "NNS LOSS": 1,
    "NNS ATTN": -1,
    "NNS %": -0.16666666666666666,
    "NNS GLIDESLOPE %": -0.9031007751937987,
    "AC TTCU GOAL": 41,
    "AC TTCU GROSS": 11,
    "AC TTCU LOSS": 0,
    "AC TTCU ATTN": 11,
    "AC TTCU %": 0.2682926829268293,
    "PRI RATE GOAL": 7,
    "PRI RATE GROSS": 4,
    "PRI RATE LOSS": 0,
    "PRI RATE ATTN": 4,
    "PRI RATE %": 0.5714285714285714,
    "TIER": "TRITON",
    "LEVEL": 1,
    "REWARD": "Polo Mondays",
    "NF GLIDESLOPE %": 4.334883720930233,
    "ALNAV_CHANGE_PCT": -0.06595012239902087
  },
  {
    "DIVISION": "DIV 3",
    "SIZE": "LARGE",
    "STATIONS": "SANTA ANA",
    "ALNAV GOAL": 71,
    "ALNAV GROSS": 14,
    "ALNAV LOSS": 0,
    "ALNAV ATTN": 14,
    "ALNAV %": 0.19718309859154928,
    "ALNAV GLIDESLOPE %": 1.0684572551588605,
    "AC GOAL": 70,
    "AC GROSS": 12,
    "AC LOSS": 0,
    "AC ATTN": 12,
    "AC %": 0.17142857142857143,
    "AC GLIDESLOPE %": 0.9289036544850501,
    "RC GOAL": 1,
    "RC GROSS": 2,
    "RC LOSS": 0,
    "RC ATTN": 2,
    "RC %": 2,
    "RC GLIDESLOPE %": 10.837209302325585,
    "NAT GOAL": 1,
    "NAT GROSS": 1,
    "NAT LOSS": 0,
    "NAT ATTN": 1,
    "NAT %": 1,
    "NAT GLIDESLOPE %": 5.418604651162792,
    "TAR GOAL": 0,
    "TAR GROSS": 1,
    "TAR LOSS": 0,
    "TAR ATTN": 1,
    "TAR %": 1,
    "NUKE GOAL": 4,
    "NUKE GROSS": 0,
    "NUKE LOSS": 0,
    "NUKE ATTN": 0,
    "NUKE %": 0,
    "NUKE GLIDESLOPE %": 0,
    "NSO GOAL": 3,
    "NSO GROSS": 1,
    "NSO LOSS": 0,
    "NSO ATTN": 1,
    "NSO %": 0.3333333333333333,
    "NSO GLIDESLOPE %": 1.8062015503875974,
    "NNS GOAL": 4,
    "NNS GROSS": 0,
    "NNS LOSS": 0,
    "NNS ATTN": 0,
    "NNS %": 0,
    "NNS GLIDESLOPE %": 0,
    "AC TTCU GOAL": 41,
    "AC TTCU GROSS": 6,
    "AC TTCU LOSS": 0,
    "AC TTCU ATTN": 6,
    "AC TTCU %": 0.14634146341463414,
    "PRI RATE GOAL": 7,
    "PRI RATE GROSS": 4,
    "PRI RATE LOSS": 1,
    "PRI RATE ATTN": 3,
    "PRI RATE %": 0.42857142857142855,
    "TIER": "TRITON",
    "LEVEL": 1,
    "REWARD": "Polo Mondays",
    "NF GLIDESLOPE %": 0,
    "ALNAV_CHANGE_PCT": 0.11849431965107682
  },
  {
    "DIVISION": "DIV 5",
    "SIZE": "MEDIUM",
    "STATIONS": "CORONA",
    "ALNAV GOAL": 83,
    "ALNAV GROSS": 17,
    "ALNAV LOSS": 1,
    "ALNAV ATTN": 16,
    "ALNAV %": 0.1927710843373494,
    "ALNAV GLIDESLOPE %": 1.0445502942000564,
    "AC GOAL": 81,
    "AC GROSS": 17,
    "AC LOSS": 1,
    "AC ATTN": 16,
    "AC %": 0.19753086419753085,
    "AC GLIDESLOPE %": 1.0703416594889466,
    "RC GOAL": 2,
    "RC GROSS": 0,
    "RC LOSS": 0,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 7,
    "NUKE GROSS": 3,
    "NUKE LOSS": 1,
    "NUKE ATTN": 2,
    "NUKE %": 0.2857142857142857,
    "NUKE GLIDESLOPE %": 1.5481727574750834,
    "NSO GOAL": 4,
    "NSO GROSS": 1,
    "NSO LOSS": 0,
    "NSO ATTN": 1,
    "NSO %": 0.25,
    "NSO GLIDESLOPE %": 1.354651162790698,
    "NNS GOAL": 5,
    "NNS GROSS": 0,
    "NNS LOSS": 0,
    "NNS ATTN": 0,
    "NNS %": 0,
    "NNS GLIDESLOPE %": 0,
    "AC TTCU GOAL": 51,
    "AC TTCU GROSS": 11,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 10,
    "AC TTCU %": 0.19607843137254902,
    "PRI RATE GOAL": 8,
    "PRI RATE GROSS": 3,
    "PRI RATE LOSS": 1,
    "PRI RATE ATTN": 2,
    "PRI RATE %": 0.25,
    "TIER": "TRITON",
    "LEVEL": 2,
    "REWARD": "1x 72-hour special liberty",
    "NF GLIDESLOPE %": 1.5481727574750834,
    "ALNAV_CHANGE_PCT": -0.06356638303520068
  },
  {
    "DIVISION": "DIV 2",
    "SIZE": "SMALL",
    "STATIONS": "POWAY",
    "ALNAV GOAL": 61,
    "ALNAV GROSS": 12,
    "ALNAV LOSS": 1,
    "ALNAV ATTN": 11,
    "ALNAV %": 0.18032786885245902,
    "ALNAV GLIDESLOPE %": 0.9771254288982084,
    "AC GOAL": 60,
    "AC GROSS": 12,
    "AC LOSS": 1,
    "AC ATTN": 11,
    "AC %": 0.18333333333333332,
    "AC GLIDESLOPE %": 0.9934108527131785,
    "RC GOAL": 1,
    "RC GROSS": 0,
    "RC LOSS": 0,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 0,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 1,
    "NUKE GOAL": 5,
    "NUKE GROSS": 0,
    "NUKE LOSS": 0,
    "NUKE ATTN": 0,
    "NUKE %": 0,
    "NUKE GLIDESLOPE %": 0,
    "NSO GOAL": 4,
    "NSO GROSS": 0,
    "NSO LOSS": 0,
    "NSO ATTN": 0,
    "NSO %": 0,
    "NSO GLIDESLOPE %": 0,
    "NNS GOAL": 3,
    "NNS GROSS": 3,
    "NNS LOSS": 1,
    "NNS ATTN": 2,
    "NNS %": 0.6666666666666666,
    "NNS GLIDESLOPE %": 3.612403100775195,
    "AC TTCU GOAL": 37,
    "AC TTCU GROSS": 8,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 7,
    "AC TTCU %": 0.1891891891891892,
    "PRI RATE GOAL": 6,
    "PRI RATE GROSS": 2,
    "PRI RATE LOSS": 1,
    "PRI RATE ATTN": 1,
    "PRI RATE %": 0.16666666666666666,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 0,
    "ALNAV_CHANGE_PCT": -0.12856913538134307
  },
  {
    "DIVISION": "DIV 7",
    "SIZE": "LARGE",
    "STATIONS": "SPRING VALLEY",
    "ALNAV GOAL": 89,
    "ALNAV GROSS": 20,
    "ALNAV LOSS": 4,
    "ALNAV ATTN": 16,
    "ALNAV %": 0.1797752808988764,
    "ALNAV GLIDESLOPE %": 0.9741311732427491,
    "AC GOAL": 87,
    "AC GROSS": 19,
    "AC LOSS": 4,
    "AC ATTN": 15,
    "AC %": 0.1724137931034483,
    "AC GLIDESLOPE %": 0.9342421812349642,
    "RC GOAL": 2,
    "RC GROSS": 1,
    "RC LOSS": 0,
    "RC ATTN": 1,
    "RC %": 0.5,
    "RC GLIDESLOPE %": 2.709302325581396,
    "NAT GOAL": 1,
    "NAT GROSS": 1,
    "NAT LOSS": 0,
    "NAT ATTN": 1,
    "NAT %": 1,
    "NAT GLIDESLOPE %": 5.418604651162792,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 5,
    "NUKE GROSS": 2,
    "NUKE LOSS": 0,
    "NUKE ATTN": 2,
    "NUKE %": 0.4,
    "NUKE GLIDESLOPE %": 2.1674418604651167,
    "NSO GOAL": 4,
    "NSO GROSS": 0,
    "NSO LOSS": 0,
    "NSO ATTN": 0,
    "NSO %": 0,
    "NSO GLIDESLOPE %": 0,
    "NNS GOAL": 5,
    "NNS GROSS": 1,
    "NNS LOSS": 0,
    "NNS ATTN": 1,
    "NNS %": 0.2,
    "NNS GLIDESLOPE %": 1.0837209302325583,
    "AC TTCU GOAL": 53,
    "AC TTCU GROSS": 14,
    "AC TTCU LOSS": 4,
    "AC TTCU ATTN": 10,
    "AC TTCU %": 0.18867924528301888,
    "PRI RATE GOAL": 7,
    "PRI RATE GROSS": 5,
    "PRI RATE LOSS": 0,
    "PRI RATE ATTN": 5,
    "PRI RATE %": 0.7142857142857143,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 2.1674418604651167,
    "ALNAV_CHANGE_PCT": -0.05928100889799626
  },
  {
    "DIVISION": "DIV 3",
    "SIZE": "MEDIUM",
    "STATIONS": "MISSION VIEJO",
    "ALNAV GOAL": 68,
    "ALNAV GROSS": 12,
    "ALNAV LOSS": 0,
    "ALNAV ATTN": 12,
    "ALNAV %": 0.17647058823529413,
    "ALNAV GLIDESLOPE %": 0.9562243502051986,
    "AC GOAL": 67,
    "AC GROSS": 12,
    "AC LOSS": 0,
    "AC ATTN": 12,
    "AC %": 0.1791044776119403,
    "AC GLIDESLOPE %": 0.9704963554321419,
    "RC GOAL": 1,
    "RC GROSS": 0,
    "RC LOSS": 0,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 0,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 1,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 8,
    "NUKE GROSS": 3,
    "NUKE LOSS": 0,
    "NUKE ATTN": 3,
    "NUKE %": 0.375,
    "NUKE GLIDESLOPE %": 2.0319767441860472,
    "NSO GOAL": 7,
    "NSO GROSS": 0,
    "NSO LOSS": 1,
    "NSO ATTN": -1,
    "NSO %": -0.14285714285714285,
    "NSO GLIDESLOPE %": -0.7740863787375417,
    "NNS GOAL": 4,
    "NNS GROSS": 2,
    "NNS LOSS": 1,
    "NNS ATTN": 1,
    "NNS %": 0.25,
    "NNS GLIDESLOPE %": 1.354651162790698,
    "AC TTCU GOAL": 41,
    "AC TTCU GROSS": 9,
    "AC TTCU LOSS": 0,
    "AC TTCU ATTN": 9,
    "AC TTCU %": 0.21951219512195122,
    "PRI RATE GOAL": 6,
    "PRI RATE GROSS": 0,
    "PRI RATE LOSS": 1,
    "PRI RATE ATTN": -1,
    "PRI RATE %": -0.16666666666666666,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 2.0319767441860472,
    "ALNAV_CHANGE_PCT": -0.03564871481028142
  },
  {
    "DIVISION": "DIV 2",
    "SIZE": "MEGA",
    "STATIONS": "OCEANSIDE",
    "ALNAV GOAL": 131,
    "ALNAV GROSS": 25,
    "ALNAV LOSS": 2,
    "ALNAV ATTN": 23,
    "ALNAV %": 0.17557251908396945,
    "ALNAV GLIDESLOPE %": 0.951358068524765,
    "AC GOAL": 129,
    "AC GROSS": 24,
    "AC LOSS": 1,
    "AC ATTN": 23,
    "AC %": 0.17829457364341086,
    "AC GLIDESLOPE %": 0.966107806021273,
    "RC GOAL": 2,
    "RC GROSS": 1,
    "RC LOSS": 1,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 1,
    "NAT GROSS": 1,
    "NAT LOSS": 0,
    "NAT ATTN": 1,
    "NAT %": 1,
    "NAT GLIDESLOPE %": 5.418604651162792,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 1,
    "TAR ATTN": -1,
    "TAR %": -1,
    "TAR GLIDESLOPE %": -5.418604651162792,
    "NUKE GOAL": 10,
    "NUKE GROSS": 1,
    "NUKE LOSS": 0,
    "NUKE ATTN": 1,
    "NUKE %": 0.1,
    "NUKE GLIDESLOPE %": 0.5418604651162792,
    "NSO GOAL": 5,
    "NSO GROSS": 2,
    "NSO LOSS": 0,
    "NSO ATTN": 2,
    "NSO %": 0.4,
    "NSO GLIDESLOPE %": 2.1674418604651167,
    "NNS GOAL": 11,
    "NNS GROSS": 1,
    "NNS LOSS": 1,
    "NNS ATTN": 0,
    "NNS %": 0,
    "NNS GLIDESLOPE %": 0,
    "AC TTCU GOAL": 67,
    "AC TTCU GROSS": 19,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 18,
    "AC TTCU %": 0.26865671641791045,
    "PRI RATE GOAL": 10,
    "PRI RATE GROSS": 5,
    "PRI RATE LOSS": 1,
    "PRI RATE ATTN": 4,
    "PRI RATE %": 0.4,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 0.5418604651162792,
    "ALNAV_CHANGE_PCT": -0.07837274706382502
  },
  {
    "DIVISION": "DIV 1",
    "SIZE": "MEGA",
    "STATIONS": "NATIONAL CITY",
    "ALNAV GOAL": 155,
    "ALNAV GROSS": 35,
    "ALNAV LOSS": 10,
    "ALNAV ATTN": 25,
    "ALNAV %": 0.16129032258064516,
    "ALNAV GLIDESLOPE %": 0.873968492123031,
    "AC GOAL": 151,
    "AC GROSS": 33,
    "AC LOSS": 10,
    "AC ATTN": 23,
    "AC %": 0.152317880794702,
    "AC GLIDESLOPE %": 0.825350377329432,
    "RC GOAL": 4,
    "RC GROSS": 2,
    "RC LOSS": 0,
    "RC ATTN": 2,
    "RC %": 0.5,
    "RC GLIDESLOPE %": 2.709302325581396,
    "NAT GOAL": 2,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 2,
    "TAR GROSS": 2,
    "TAR LOSS": 0,
    "TAR ATTN": 2,
    "TAR %": 1,
    "TAR GLIDESLOPE %": 5.418604651162792,
    "NUKE GOAL": 6,
    "NUKE GROSS": 3,
    "NUKE LOSS": 1,
    "NUKE ATTN": 2,
    "NUKE %": 0.3333333333333333,
    "NUKE GLIDESLOPE %": 1.8062015503875974,
    "NSO GOAL": 7,
    "NSO GROSS": 0,
    "NSO LOSS": 0,
    "NSO ATTN": 0,
    "NSO %": 0,
    "NSO GLIDESLOPE %": 0,
    "NNS GOAL": 6,
    "NNS GROSS": 2,
    "NNS LOSS": 2,
    "NNS ATTN": 0,
    "NNS %": 0,
    "NNS GLIDESLOPE %": 0,
    "AC TTCU GOAL": 96,
    "AC TTCU GROSS": 22,
    "AC TTCU LOSS": 4,
    "AC TTCU ATTN": 18,
    "AC TTCU %": 0.1875,
    "PRI RATE GOAL": 16,
    "PRI RATE GROSS": 13,
    "PRI RATE LOSS": 4,
    "PRI RATE ATTN": 9,
    "PRI RATE %": 0.5625,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 1.8062015503875974,
    "ALNAV_CHANGE_PCT": -0.035878706518734926
  },
  {
    "DIVISION": "DIV 3",
    "SIZE": "MEDIUM",
    "STATIONS": "GARDEN GROVE",
    "ALNAV GOAL": 57,
    "ALNAV GROSS": 11,
    "ALNAV LOSS": 2,
    "ALNAV ATTN": 9,
    "ALNAV %": 0.15789473684210525,
    "ALNAV GLIDESLOPE %": 0.8555691554467566,
    "AC GOAL": 55,
    "AC GROSS": 11,
    "AC LOSS": 1,
    "AC ATTN": 10,
    "AC %": 0.18181818181818182,
    "AC GLIDESLOPE %": 0.9852008456659622,
    "RC GOAL": 2,
    "RC GROSS": 0,
    "RC LOSS": 1,
    "RC ATTN": -1,
    "RC %": -0.5,
    "RC GLIDESLOPE %": -2.709302325581396,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 1,
    "NAT ATTN": -1,
    "NAT %": -1,
    "NAT GLIDESLOPE %": -5.418604651162792,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 3,
    "NUKE GROSS": 1,
    "NUKE LOSS": 0,
    "NUKE ATTN": 1,
    "NUKE %": 0.3333333333333333,
    "NUKE GLIDESLOPE %": 1.8062015503875974,
    "NSO GOAL": 1,
    "NSO GROSS": 0,
    "NSO LOSS": 0,
    "NSO ATTN": 0,
    "NSO %": 0,
    "NSO GLIDESLOPE %": 0,
    "NNS GOAL": 4,
    "NNS GROSS": 0,
    "NNS LOSS": 0,
    "NNS ATTN": 0,
    "NNS %": 0,
    "NNS GLIDESLOPE %": 0,
    "AC TTCU GOAL": 38,
    "AC TTCU GROSS": 8,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 7,
    "AC TTCU %": 0.18421052631578946,
    "PRI RATE GOAL": 6,
    "PRI RATE GROSS": 5,
    "PRI RATE LOSS": 1,
    "PRI RATE ATTN": 4,
    "PRI RATE %": 0.6666666666666666,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 1.8062015503875974,
    "ALNAV_CHANGE_PCT": -0.11257488887457334
  },
  {
    "DIVISION": "DIV 1",
    "SIZE": "LARGE",
    "STATIONS": "EL CAJON",
    "ALNAV GOAL": 109,
    "ALNAV GROSS": 19,
    "ALNAV LOSS": 2,
    "ALNAV ATTN": 17,
    "ALNAV %": 0.1559633027522936,
    "ALNAV GLIDESLOPE %": 0.8451034777042886,
    "AC GOAL": 107,
    "AC GROSS": 19,
    "AC LOSS": 2,
    "AC ATTN": 17,
    "AC %": 0.1588785046728972,
    "AC GLIDESLOPE %": 0.8608998043903502,
    "RC GOAL": 2,
    "RC GROSS": 0,
    "RC LOSS": 0,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 8,
    "NUKE GROSS": 0,
    "NUKE LOSS": 0,
    "NUKE ATTN": 0,
    "NUKE %": 0,
    "NUKE GLIDESLOPE %": 0,
    "NSO GOAL": 6,
    "NSO GROSS": 1,
    "NSO LOSS": 0,
    "NSO ATTN": 1,
    "NSO %": 0.16666666666666666,
    "NSO GLIDESLOPE %": 0.9031007751937987,
    "NNS GOAL": 7,
    "NNS GROSS": 1,
    "NNS LOSS": 0,
    "NNS ATTN": 1,
    "NNS %": 0.14285714285714285,
    "NNS GLIDESLOPE %": 0.7740863787375417,
    "AC TTCU GOAL": 68,
    "AC TTCU GROSS": 15,
    "AC TTCU LOSS": 0,
    "AC TTCU ATTN": 15,
    "AC TTCU %": 0.22058823529411764,
    "PRI RATE GOAL": 8,
    "PRI RATE GROSS": 3,
    "PRI RATE LOSS": 0,
    "PRI RATE ATTN": 3,
    "PRI RATE %": 0.375,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 0,
    "ALNAV_CHANGE_PCT": -0.05494480814795699
  },
  {
    "DIVISION": "DIV 3",
    "SIZE": "MEDIUM",
    "STATIONS": "ANAHEIM",
    "ALNAV GOAL": 65,
    "ALNAV GROSS": 15,
    "ALNAV LOSS": 5,
    "ALNAV ATTN": 10,
    "ALNAV %": 0.15384615384615385,
    "ALNAV GLIDESLOPE %": 0.8336314847942757,
    "AC GOAL": 64,
    "AC GROSS": 15,
    "AC LOSS": 5,
    "AC ATTN": 10,
    "AC %": 0.15625,
    "AC GLIDESLOPE %": 0.8466569767441863,
    "RC GOAL": 1,
    "RC GROSS": 0,
    "RC LOSS": 0,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 0,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 1,
    "NUKE GOAL": 4,
    "NUKE GROSS": 1,
    "NUKE LOSS": 0,
    "NUKE ATTN": 1,
    "NUKE %": 0.25,
    "NUKE GLIDESLOPE %": 1.354651162790698,
    "NSO GOAL": 2,
    "NSO GROSS": 1,
    "NSO LOSS": 2,
    "NSO ATTN": -1,
    "NSO %": -0.5,
    "NSO GLIDESLOPE %": -2.709302325581396,
    "NNS GOAL": 5,
    "NNS GROSS": 1,
    "NNS LOSS": 0,
    "NNS ATTN": 1,
    "NNS %": 0.2,
    "NNS GLIDESLOPE %": 1.0837209302325583,
    "AC TTCU GOAL": 37,
    "AC TTCU GROSS": 9,
    "AC TTCU LOSS": 3,
    "AC TTCU ATTN": 6,
    "AC TTCU %": 0.16216216216216217,
    "PRI RATE GOAL": 7,
    "PRI RATE GROSS": 7,
    "PRI RATE LOSS": 1,
    "PRI RATE ATTN": 6,
    "PRI RATE %": 0.8571428571428571,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 1.354651162790698,
    "ALNAV_CHANGE_PCT": -0.015356369456736685
  },
  {
    "DIVISION": "DIV 6",
    "SIZE": "SMALL",
    "STATIONS": "FONTANA",
    "ALNAV GOAL": 77,
    "ALNAV GROSS": 12,
    "ALNAV LOSS": 1,
    "ALNAV ATTN": 11,
    "ALNAV %": 0.14285714285714285,
    "ALNAV GLIDESLOPE %": 0.7740863787375417,
    "AC GOAL": 75,
    "AC GROSS": 11,
    "AC LOSS": 0,
    "AC ATTN": 11,
    "AC %": 0.14666666666666667,
    "AC GLIDESLOPE %": 0.7947286821705428,
    "RC GOAL": 2,
    "RC GROSS": 1,
    "RC LOSS": 1,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 1,
    "NAT GROSS": 1,
    "NAT LOSS": 1,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 7,
    "NUKE GROSS": 1,
    "NUKE LOSS": 0,
    "NUKE ATTN": 1,
    "NUKE %": 0.14285714285714285,
    "NUKE GLIDESLOPE %": 0.7740863787375417,
    "NSO GOAL": 5,
    "NSO GROSS": 1,
    "NSO LOSS": 1,
    "NSO ATTN": 0,
    "NSO %": 0,
    "NSO GLIDESLOPE %": 0,
    "NNS GOAL": 6,
    "NNS GROSS": 0,
    "NNS LOSS": 0,
    "NNS ATTN": 0,
    "NNS %": 0,
    "NNS GLIDESLOPE %": 0,
    "AC TTCU GOAL": 55,
    "AC TTCU GROSS": 5,
    "AC TTCU LOSS": 0,
    "AC TTCU ATTN": 5,
    "AC TTCU %": 0.09090909090909091,
    "PRI RATE GOAL": 9,
    "PRI RATE GROSS": 8,
    "PRI RATE LOSS": 1,
    "PRI RATE ATTN": 7,
    "PRI RATE %": 0.7777777777777778,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 0.7740863787375417,
    "ALNAV_CHANGE_PCT": 0.2166701107949579
  },
  {
    "DIVISION": "DIV 1",
    "SIZE": "LARGE",
    "STATIONS": "YUMA",
    "ALNAV GOAL": 57,
    "ALNAV GROSS": 8,
    "ALNAV LOSS": 0,
    "ALNAV ATTN": 8,
    "ALNAV %": 0.14035087719298245,
    "ALNAV GLIDESLOPE %": 0.7605059159526726,
    "AC GOAL": 57,
    "AC GROSS": 8,
    "AC LOSS": 0,
    "AC ATTN": 8,
    "AC %": 0.14035087719298245,
    "AC GLIDESLOPE %": 0.7605059159526726,
    "RC GOAL": 0,
    "RC GROSS": 0,
    "RC LOSS": 0,
    "RC ATTN": 0,
    "RC %": 1,
    "RC GLIDESLOPE %": 1,
    "NAT GOAL": 0,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 1,
    "TAR GOAL": 0,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 1,
    "NUKE GOAL": 6,
    "NUKE GROSS": 1,
    "NUKE LOSS": 0,
    "NUKE ATTN": 1,
    "NUKE %": 0.16666666666666666,
    "NUKE GLIDESLOPE %": 0.9031007751937987,
    "NSO GOAL": 4,
    "NSO GROSS": 0,
    "NSO LOSS": 0,
    "NSO ATTN": 0,
    "NSO %": 0,
    "NSO GLIDESLOPE %": 0,
    "NNS GOAL": 6,
    "NNS GROSS": 1,
    "NNS LOSS": 1,
    "NNS ATTN": 0,
    "NNS %": 0,
    "NNS GLIDESLOPE %": 0,
    "AC TTCU GOAL": 36,
    "AC TTCU GROSS": 4,
    "AC TTCU LOSS": 0,
    "AC TTCU ATTN": 4,
    "AC TTCU %": 0.1111111111111111,
    "PRI RATE GOAL": 8,
    "PRI RATE GROSS": 1,
    "PRI RATE LOSS": 0,
    "PRI RATE ATTN": 1,
    "PRI RATE %": 0.125,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 0.9031007751937987,
    "ALNAV_CHANGE_PCT": -0.10006656788850954
  },
  {
    "DIVISION": "DIV 3",
    "SIZE": "MEDIUM",
    "STATIONS": "HUN BEACH",
    "ALNAV GOAL": 65,
    "ALNAV GROSS": 10,
    "ALNAV LOSS": 1,
    "ALNAV ATTN": 9,
    "ALNAV %": 0.13846153846153847,
    "ALNAV GLIDESLOPE %": 0.7502683363148481,
    "AC GOAL": 64,
    "AC GROSS": 9,
    "AC LOSS": 1,
    "AC ATTN": 8,
    "AC %": 0.125,
    "AC GLIDESLOPE %": 0.677325581395349,
    "RC GOAL": 0,
    "RC GROSS": 1,
    "RC LOSS": 0,
    "RC ATTN": 1,
    "RC %": 1,
    "RC GLIDESLOPE %": 1,
    "NAT GOAL": 0,
    "NAT GROSS": 1,
    "NAT LOSS": 0,
    "NAT ATTN": 1,
    "NAT %": 1,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 5,
    "NUKE GROSS": 1,
    "NUKE LOSS": 0,
    "NUKE ATTN": 1,
    "NUKE %": 0.2,
    "NUKE GLIDESLOPE %": 1.0837209302325583,
    "NSO GOAL": 5,
    "NSO GROSS": 2,
    "NSO LOSS": 0,
    "NSO ATTN": 2,
    "NSO %": 0.4,
    "NSO GLIDESLOPE %": 2.1674418604651167,
    "NNS GOAL": 4,
    "NNS GROSS": 1,
    "NNS LOSS": 1,
    "NNS ATTN": 0,
    "NNS %": 0,
    "NNS GLIDESLOPE %": 0,
    "AC TTCU GOAL": 39,
    "AC TTCU GROSS": 7,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 6,
    "AC TTCU %": 0.15384615384615385,
    "PRI RATE GOAL": 7,
    "PRI RATE GROSS": 1,
    "PRI RATE LOSS": 2,
    "PRI RATE ATTN": -1,
    "PRI RATE %": -0.14285714285714285,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 1.0837209302325583,
    "ALNAV_CHANGE_PCT": -0.09871951793616429
  },
  {
    "DIVISION": "DIV 4",
    "SIZE": "MEDIUM",
    "STATIONS": "MORENO VALLEY",
    "ALNAV GOAL": 80,
    "ALNAV GROSS": 17,
    "ALNAV LOSS": 6,
    "ALNAV ATTN": 11,
    "ALNAV %": 0.1375,
    "ALNAV GLIDESLOPE %": 0.7450581395348839,
    "AC GOAL": 78,
    "AC GROSS": 16,
    "AC LOSS": 3,
    "AC ATTN": 13,
    "AC %": 0.16666666666666666,
    "AC GLIDESLOPE %": 0.9031007751937987,
    "RC GOAL": 2,
    "RC GROSS": 1,
    "RC LOSS": 3,
    "RC ATTN": -2,
    "RC %": -1,
    "RC GLIDESLOPE %": -5.418604651162792,
    "NAT GOAL": 1,
    "NAT GROSS": 1,
    "NAT LOSS": 1,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 2,
    "TAR ATTN": -2,
    "TAR %": -2,
    "TAR GLIDESLOPE %": -10.837209302325585,
    "NUKE GOAL": 5,
    "NUKE GROSS": 0,
    "NUKE LOSS": 0,
    "NUKE ATTN": 0,
    "NUKE %": 0,
    "NUKE GLIDESLOPE %": 0,
    "NSO GOAL": 3,
    "NSO GROSS": 0,
    "NSO LOSS": 0,
    "NSO ATTN": 0,
    "NSO %": 0,
    "NSO GLIDESLOPE %": 0,
    "NNS GOAL": 5,
    "NNS GROSS": 2,
    "NNS LOSS": 1,
    "NNS ATTN": 1,
    "NNS %": 0.2,
    "NNS GLIDESLOPE %": 1.0837209302325583,
    "AC TTCU GOAL": 41,
    "AC TTCU GROSS": 7,
    "AC TTCU LOSS": 2,
    "AC TTCU ATTN": 5,
    "AC TTCU %": 0.12195121951219512,
    "PRI RATE GOAL": 6,
    "PRI RATE GROSS": 5,
    "PRI RATE LOSS": 1,
    "PRI RATE ATTN": 4,
    "PRI RATE %": 0.6666666666666666,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 0,
    "ALNAV_CHANGE_PCT": -0.0213892288861689
  },
  {
    "DIVISION": "DIV 1",
    "SIZE": "MEDIUM",
    "STATIONS": "IMPERIAL BEACH",
    "ALNAV GOAL": 84,
    "ALNAV GROSS": 14,
    "ALNAV LOSS": 3,
    "ALNAV ATTN": 11,
    "ALNAV %": 0.13095238095238096,
    "ALNAV GLIDESLOPE %": 0.7095791805094133,
    "AC GOAL": 82,
    "AC GROSS": 14,
    "AC LOSS": 2,
    "AC ATTN": 12,
    "AC %": 0.14634146341463414,
    "AC GLIDESLOPE %": 0.7929665343165061,
    "RC GOAL": 2,
    "RC GROSS": 0,
    "RC LOSS": 1,
    "RC ATTN": -1,
    "RC %": -0.5,
    "RC GLIDESLOPE %": -2.709302325581396,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 1,
    "TAR ATTN": -1,
    "TAR %": -1,
    "TAR GLIDESLOPE %": -5.418604651162792,
    "NUKE GOAL": 6,
    "NUKE GROSS": 1,
    "NUKE LOSS": 0,
    "NUKE ATTN": 1,
    "NUKE %": 0.16666666666666666,
    "NUKE GLIDESLOPE %": 0.9031007751937987,
    "NSO GOAL": 6,
    "NSO GROSS": 2,
    "NSO LOSS": 0,
    "NSO ATTN": 2,
    "NSO %": 0.3333333333333333,
    "NSO GLIDESLOPE %": 1.8062015503875974,
    "NNS GOAL": 6,
    "NNS GROSS": 2,
    "NNS LOSS": 0,
    "NNS ATTN": 2,
    "NNS %": 0.3333333333333333,
    "NNS GLIDESLOPE %": 1.8062015503875974,
    "AC TTCU GOAL": 56,
    "AC TTCU GROSS": 7,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 6,
    "AC TTCU %": 0.10714285714285714,
    "PRI RATE GOAL": 8,
    "PRI RATE GROSS": 5,
    "PRI RATE LOSS": 2,
    "PRI RATE ATTN": 3,
    "PRI RATE %": 0.375,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 0.9031007751937987,
    "ALNAV_CHANGE_PCT": -0.09336568164597536
  },
  {
    "DIVISION": "DIV 7",
    "SIZE": "MEDIUM",
    "STATIONS": "RED ROCK",
    "ALNAV GOAL": 79,
    "ALNAV GROSS": 13,
    "ALNAV LOSS": 3,
    "ALNAV ATTN": 10,
    "ALNAV %": 0.12658227848101267,
    "ALNAV GLIDESLOPE %": 0.685899322931999,
    "AC GOAL": 77,
    "AC GROSS": 13,
    "AC LOSS": 3,
    "AC ATTN": 10,
    "AC %": 0.12987012987012986,
    "AC GLIDESLOPE %": 0.7037148897614016,
    "RC GOAL": 2,
    "RC GROSS": 0,
    "RC LOSS": 0,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 5,
    "NUKE GROSS": 2,
    "NUKE LOSS": 0,
    "NUKE ATTN": 2,
    "NUKE %": 0.4,
    "NUKE GLIDESLOPE %": 2.1674418604651167,
    "NSO GOAL": 4,
    "NSO GROSS": 0,
    "NSO LOSS": 0,
    "NSO ATTN": 0,
    "NSO %": 0,
    "NSO GLIDESLOPE %": 0,
    "NNS GOAL": 5,
    "NNS GROSS": 2,
    "NNS LOSS": 2,
    "NNS ATTN": 0,
    "NNS %": 0,
    "NNS GLIDESLOPE %": 0,
    "AC TTCU GOAL": 53,
    "AC TTCU GROSS": 7,
    "AC TTCU LOSS": 2,
    "AC TTCU ATTN": 5,
    "AC TTCU %": 0.09433962264150944,
    "PRI RATE GOAL": 7,
    "PRI RATE GROSS": 3,
    "PRI RATE LOSS": 0,
    "PRI RATE ATTN": 3,
    "PRI RATE %": 0.42857142857142855,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 2.1674418604651167,
    "ALNAV_CHANGE_PCT": -0.012634987527694652
  },
  {
    "DIVISION": "DIV 7",
    "SIZE": "MEGA",
    "STATIONS": "NORTHERN LIGHTS",
    "ALNAV GOAL": 129,
    "ALNAV GROSS": 19,
    "ALNAV LOSS": 3,
    "ALNAV ATTN": 16,
    "ALNAV %": 0.12403100775193798,
    "ALNAV GLIDESLOPE %": 0.6720749954930595,
    "AC GOAL": 127,
    "AC GROSS": 17,
    "AC LOSS": 3,
    "AC ATTN": 14,
    "AC %": 0.11023622047244094,
    "AC GLIDESLOPE %": 0.5973264969785755,
    "RC GOAL": 2,
    "RC GROSS": 2,
    "RC LOSS": 0,
    "RC ATTN": 2,
    "RC %": 1,
    "RC GLIDESLOPE %": 5.418604651162792,
    "NAT GOAL": 1,
    "NAT GROSS": 2,
    "NAT LOSS": 0,
    "NAT ATTN": 2,
    "NAT %": 2,
    "NAT GLIDESLOPE %": 10.837209302325585,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 8,
    "NUKE GROSS": 1,
    "NUKE LOSS": 0,
    "NUKE ATTN": 1,
    "NUKE %": 0.125,
    "NUKE GLIDESLOPE %": 0.677325581395349,
    "NSO GOAL": 7,
    "NSO GROSS": 1,
    "NSO LOSS": 0,
    "NSO ATTN": 1,
    "NSO %": 0.14285714285714285,
    "NSO GLIDESLOPE %": 0.7740863787375417,
    "NNS GOAL": 8,
    "NNS GROSS": 1,
    "NNS LOSS": 2,
    "NNS ATTN": -1,
    "NNS %": -0.125,
    "NNS GLIDESLOPE %": -0.677325581395349,
    "AC TTCU GOAL": 56,
    "AC TTCU GROSS": 8,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 7,
    "AC TTCU %": 0.125,
    "PRI RATE GOAL": 12,
    "PRI RATE GROSS": 4,
    "PRI RATE LOSS": 1,
    "PRI RATE ATTN": 3,
    "PRI RATE %": 0.25,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 0.677325581395349,
    "ALNAV_CHANGE_PCT": -0.0884309204596131
  },
  {
    "DIVISION": "DIV 6",
    "SIZE": "SMALL",
    "STATIONS": "REDLANDS",
    "ALNAV GOAL": 87,
    "ALNAV GROSS": 10,
    "ALNAV LOSS": 1,
    "ALNAV ATTN": 9,
    "ALNAV %": 0.10344827586206896,
    "ALNAV GLIDESLOPE %": 0.5605453087409785,
    "AC GOAL": 85,
    "AC GROSS": 10,
    "AC LOSS": 1,
    "AC ATTN": 9,
    "AC %": 0.10588235294117647,
    "AC GLIDESLOPE %": 0.5737346101231191,
    "RC GOAL": 2,
    "RC GROSS": 0,
    "RC LOSS": 0,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 6,
    "NUKE GROSS": 1,
    "NUKE LOSS": 0,
    "NUKE ATTN": 1,
    "NUKE %": 0.16666666666666666,
    "NUKE GLIDESLOPE %": 0.9031007751937987,
    "NSO GOAL": 5,
    "NSO GROSS": 2,
    "NSO LOSS": 0,
    "NSO ATTN": 2,
    "NSO %": 0.4,
    "NSO GLIDESLOPE %": 2.1674418604651167,
    "NNS GOAL": 6,
    "NNS GROSS": 1,
    "NNS LOSS": 0,
    "NNS ATTN": 1,
    "NNS %": 0.16666666666666666,
    "NNS GLIDESLOPE %": 0.9031007751937987,
    "AC TTCU GOAL": 55,
    "AC TTCU GROSS": 5,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 4,
    "AC TTCU %": 0.07272727272727272,
    "PRI RATE GOAL": 9,
    "PRI RATE GROSS": 1,
    "PRI RATE LOSS": 0,
    "PRI RATE ATTN": 1,
    "PRI RATE %": 0.1111111111111111,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 0.9031007751937987,
    "ALNAV_CHANGE_PCT": -0.07375596167644449
  },
  {
    "DIVISION": "DIV 5",
    "SIZE": "LARGE",
    "STATIONS": "BREA",
    "ALNAV GOAL": 85,
    "ALNAV GROSS": 11,
    "ALNAV LOSS": 3,
    "ALNAV ATTN": 8,
    "ALNAV %": 0.09411764705882353,
    "ALNAV GLIDESLOPE %": 0.5099863201094392,
    "AC GOAL": 83,
    "AC GROSS": 10,
    "AC LOSS": 3,
    "AC ATTN": 7,
    "AC %": 0.08433734939759036,
    "AC GLIDESLOPE %": 0.4569907537125246,
    "RC GOAL": 2,
    "RC GROSS": 1,
    "RC LOSS": 0,
    "RC ATTN": 1,
    "RC %": 0.5,
    "RC GLIDESLOPE %": 2.709302325581396,
    "NAT GOAL": 1,
    "NAT GROSS": 1,
    "NAT LOSS": 0,
    "NAT ATTN": 1,
    "NAT %": 1,
    "NAT GLIDESLOPE %": 5.418604651162792,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 6,
    "NUKE GROSS": 0,
    "NUKE LOSS": 0,
    "NUKE ATTN": 0,
    "NUKE %": 0,
    "NUKE GLIDESLOPE %": 0,
    "NSO GOAL": 4,
    "NSO GROSS": 0,
    "NSO LOSS": 0,
    "NSO ATTN": 0,
    "NSO %": 0,
    "NSO GLIDESLOPE %": 0,
    "NNS GOAL": 6,
    "NNS GROSS": 1,
    "NNS LOSS": 0,
    "NNS ATTN": 1,
    "NNS %": 0.16666666666666666,
    "NNS GLIDESLOPE %": 0.9031007751937987,
    "AC TTCU GOAL": 50,
    "AC TTCU GROSS": 9,
    "AC TTCU LOSS": 3,
    "AC TTCU ATTN": 6,
    "AC TTCU %": 0.12,
    "PRI RATE GOAL": 8,
    "PRI RATE GROSS": 3,
    "PRI RATE LOSS": 1,
    "PRI RATE ATTN": 2,
    "PRI RATE %": 0.25,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 0,
    "ALNAV_CHANGE_PCT": 0.0050327597379220546
  },
  {
    "DIVISION": "DIV 5",
    "SIZE": "MEDIUM",
    "STATIONS": "RANCHO CUCAMONGA",
    "ALNAV GOAL": 81,
    "ALNAV GROSS": 6,
    "ALNAV LOSS": 1,
    "ALNAV ATTN": 5,
    "ALNAV %": 0.06172839506172839,
    "ALNAV GLIDESLOPE %": 0.3344817685902958,
    "AC GOAL": 79,
    "AC GROSS": 6,
    "AC LOSS": 1,
    "AC ATTN": 5,
    "AC %": 0.06329113924050633,
    "AC GLIDESLOPE %": 0.3429496614659995,
    "RC GOAL": 2,
    "RC GROSS": 0,
    "RC LOSS": 0,
    "RC ATTN": 0,
    "RC %": 0,
    "RC GLIDESLOPE %": 0,
    "NAT GOAL": 1,
    "NAT GROSS": 0,
    "NAT LOSS": 0,
    "NAT ATTN": 0,
    "NAT %": 0,
    "NAT GLIDESLOPE %": 0,
    "TAR GOAL": 1,
    "TAR GROSS": 0,
    "TAR LOSS": 0,
    "TAR ATTN": 0,
    "TAR %": 0,
    "TAR GLIDESLOPE %": 0,
    "NUKE GOAL": 7,
    "NUKE GROSS": 0,
    "NUKE LOSS": 0,
    "NUKE ATTN": 0,
    "NUKE %": 0,
    "NUKE GLIDESLOPE %": 0,
    "NSO GOAL": 5,
    "NSO GROSS": 2,
    "NSO LOSS": 0,
    "NSO ATTN": 2,
    "NSO %": 0.4,
    "NSO GLIDESLOPE %": 2.1674418604651167,
    "NNS GOAL": 5,
    "NNS GROSS": 1,
    "NNS LOSS": 0,
    "NNS ATTN": 1,
    "NNS %": 0.2,
    "NNS GLIDESLOPE %": 1.0837209302325583,
    "AC TTCU GOAL": 51,
    "AC TTCU GROSS": 3,
    "AC TTCU LOSS": 1,
    "AC TTCU ATTN": 2,
    "AC TTCU %": 0.0392156862745098,
    "PRI RATE GOAL": 8,
    "PRI RATE GROSS": 4,
    "PRI RATE LOSS": 1,
    "PRI RATE ATTN": 3,
    "PRI RATE %": 0.375,
    "TIER": "BELOW",
    "LEVEL": 0,
    "REWARD": "",
    "NF GLIDESLOPE %": 0,
    "ALNAV_CHANGE_PCT": -0.044010759025038926
  };
        // ========================================
        
        let processedData = [];
        let historicalWeeksData = [];
        const currentReportDate = { value: REPORT_DATA_CONFIG.reportDate };
        let historicalWeeksData = []; // Stores past weeks for trend analysis
        
        // FY25 Production Day Calculator
        const FY_START = new Date('2024-10-01'); // 01OCT24
        const TOTAL_FY_DAYS = 233;
        
        function getProductionDay(dateStr) {
            // Parse date string (format: "21NOV25" or "21NOV24")
            const day = parseInt(dateStr.substring(0, 2));
            const monthStr = dateStr.substring(2, 5).toUpperCase();
            const year = parseInt('20' + dateStr.substring(5, 7));
            
            const months = {
                'JAN': 0, 'FEB': 1, 'MAR': 2, 'APR': 3, 'MAY': 4, 'JUN': 5,
                'JUL': 6, 'AUG': 7, 'SEP': 8, 'OCT': 9, 'NOV': 10, 'DEC': 11
            };
            
            const date = new Date(year, months[monthStr], day);
            
            // Calculate days since FY start
            const diffTime = date - FY_START;
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24)) + 1;
            
            return Math.max(1, Math.min(diffDays, TOTAL_FY_DAYS));
        }
        let stationClickMap = []; // Store click regions for each station
        
        const uploadZone = document.getElementById('uploadZone');
        const fileInput = document.getElementById('fileInput');
        const fileName = document.getElementById('fileName');
        const uploadZonePrevious = document.getElementById('uploadZonePrevious');
        const fileInputPrevious = document.getElementById('fileInputPrevious');
        const fileNamePrevious = document.getElementById('fileNamePrevious');
        const generateBtn = document.getElementById('generateBtn');
        const statusMessage = document.getElementById('statusMessage');
        const reportOutput = document.getElementById('reportOutput');
        const reportCanvas = document.getElementById('reportCanvas');
        const downloadBtn = document.getElementById('downloadBtn');
        const downloadPdfBtn = document.getElementById('downloadPdfBtn');
        const exportDataBtn = document.getElementById('exportDataBtn');
        const exportSection = document.getElementById('exportSection');
        const exportDataText = document.getElementById('exportDataText');
        const copyDataBtn = document.getElementById('copyDataBtn');
        const copyStatus = document.getElementById('copyStatus');
        const uploadZoneHistorical = document.getElementById('uploadZoneHistorical');
        const fileInputHistorical = document.getElementById('fileInputHistorical');
        const historicalFilesList = document.getElementById('historicalFilesList');
        const processHistoricalBtn = document.getElementById('processHistoricalBtn');
        const historicalProcessStatus = document.getElementById('historicalProcessStatus');
        
        // Drag and drop for historical files
        uploadZoneHistorical.addEventListener('click', () => fileInputHistorical.click());
        uploadZoneHistorical.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadZoneHistorical.style.borderColor = '#2196f3';
            uploadZoneHistorical.style.background = 'linear-gradient(135deg, #bbdefb 0%, #e3f2fd 100%)';
        });
        uploadZoneHistorical.addEventListener('dragleave', () => {
            uploadZoneHistorical.style.borderColor = '#2196f3';
            uploadZoneHistorical.style.background = 'linear-gradient(135deg, #e3f2fd 0%, #ffffff 100%)';
        });
        uploadZoneHistorical.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadZoneHistorical.style.borderColor = '#2196f3';
            uploadZoneHistorical.style.background = 'linear-gradient(135deg, #e3f2fd 0%, #ffffff 100%)';
            fileInputHistorical.files = e.dataTransfer.files;
            displayHistoricalFiles();
        });
        
        fileInputHistorical.addEventListener('change', displayHistoricalFiles);
        
        function displayHistoricalFiles() {
            const files = fileInputHistorical.files;
            if (files.length === 0) {
                historicalFilesList.style.display = 'none';
                processHistoricalBtn.style.display = 'none';
                return;
            }
            
            historicalFilesList.style.display = 'block';
            processHistoricalBtn.style.display = 'block';
            historicalProcessStatus.style.display = 'none';
            
            let html = `<h4 style="color: #1976d2; margin-bottom: 10px;">üìÇ ${files.length} file(s) selected:</h4>`;
            html += '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;">';
            
            for (let i = 0; i < files.length; i++) {
                html += `
                    <div style="padding: 8px; background: #e3f2fd; border-radius: 4px; font-size: 12px; color: #1976d2;">
                        <strong>File ${i+1}:</strong><br>${files[i].name}
                    </div>
                `;
            }
            
            html += '</div>';
            historicalFilesList.innerHTML = html;
        }
        
        processHistoricalBtn.addEventListener('click', async () => {
            const files = fileInputHistorical.files;
            if (files.length === 0) {
                alert('Please select historical week files first');
                return;
            }
            
            historicalProcessStatus.style.display = 'block';
            historicalProcessStatus.textContent = `‚è≥ Processing ${files.length} files...`;
            historicalProcessStatus.style.color = '#ffc107';
            
            historicalWeeksData = [];
            const TOTAL_FY_DAYS = 233;
            
            // Convert FileList to array and sort by filename
            // Sort by numeric prefix (e.g., "1_", "2_", "3_")
            const sortedFiles = Array.from(files).sort((a, b) => {
                const getNum = (name) => {
                    const match = name.match(/^(\d+)/);
                    return match ? parseInt(match[1]) : 999;
                };
                return getNum(a.name) - getNum(b.name);
            });
            
            for (let weekNum = 0; weekNum < sortedFiles.length; weekNum++) {
                const file = sortedFiles[weekNum];
                
                try {
                    const data = await file.arrayBuffer();
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = 'Annual Goals & Attn';
                    
                    if (!workbook.Sheets[sheetName]) {
                        console.warn(`${file.name}: Could not find sheet "${sheetName}"`);
                        continue;
                    }
                    
                    const sheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(sheet); // Let XLSX handle type conversion
                    
                    // Extract date from filename (e.g., "07OCT25")
                    let dateStr = file.name.match(/(\d{2}[A-Z]{3}\d{2})/i);
                    dateStr = dateStr ? dateStr[1].toUpperCase() : `Week${weekNum+1}`;
                    
                    const weekData = {
                        week: weekNum + 1,
                        date: dateStr,
                        stations: []
                    };
                    
                    // Process each row
                    jsonData
                        .filter(row => row['STATIONS'] && row['STATIONS'].toString().trim() !== '')
                        .forEach(row => {
                            const stationName = row['STATIONS'];
                            let alnavGlideslopePct = row['ALNAV GLIDESLOPE %'] || 0;  // Read GLIDESLOPE %, not ALNAV %
                            
                            // Handle both formats: Excel can give us 1.898 OR 189.8
                            // If the value is > 10, it's already a percentage (189.8%)
                            // If the value is <= 10, it's a decimal (1.898 = 189.8%)
                            // Convert everything to decimal format (1.898)
                            if (alnavGlideslopePct > 10) {
                                alnavGlideslopePct = alnavGlideslopePct / 100;
                            }
                            
                            weekData.stations.push({
                                name: stationName.toString().trim(),
                                alnav_glideslope_pct: alnavGlideslopePct
                            });
                        });
                    
                    historicalWeeksData.push(weekData);
                    
                } catch (error) {
                    console.error(`Error processing ${file.name}:`, error);
                }
            }
            
            if (historicalWeeksData.length > 0) {
                historicalProcessStatus.textContent = `‚úÖ Loaded ${historicalWeeksData.length} historical weeks! Trend charts will appear in modals.`;
                historicalProcessStatus.style.color = '#28a745';
            } else {
                historicalProcessStatus.textContent = '‚ùå No historical weeks processed. Check file format.';
                historicalProcessStatus.style.color = '#dc3545';
            }
        });
        
        const exportHistoricalBtn = document.getElementById('exportHistoricalBtn');
        const historicalExportSection = document.getElementById('historicalExportSection');
        const historicalDataText = document.getElementById('historicalDataText');
        const copyHistoricalBtn = document.getElementById('copyHistoricalBtn');
        const copyHistoricalStatus = document.getElementById('copyHistoricalStatus');
        const weekNumber = document.getElementById('weekNumber');
        const historicalDataInput = document.getElementById('historicalData');
        const loadHistoricalBtn = document.getElementById('loadHistoricalBtn');
        const historicalStatus = document.getElementById('historicalStatus');
        const currentProductionDay = { value: 33 };  // Default value since field removed
        const lastProductionDay = { value: 28 };     // Default value since field removed
        const nextProductionDay = { value: 38 };     // Default value since field removed
        const currentReportDate = document.getElementById('currentReportDate');
        
        // Official FY26 Production Day Schedule (from ALNAV)
        const PROD_DAY_SCHEDULE = {
            // October 2024 (20 days) - Days 233 down to 214
            '01OCT24': 233, '02OCT24': 232, '03OCT24': 231, '04OCT24': 230, '07OCT24': 229,
            '08OCT24': 228, '09OCT24': 227, '10OCT24': 226, '11OCT24': 225, '14OCT24': 224,
            '15OCT24': 223, '16OCT24': 222, '17OCT24': 221, '18OCT24': 220, '21OCT24': 219,
            '22OCT24': 218, '23OCT24': 217, '24OCT24': 216, '25OCT24': 215, '28OCT24': 214,
            // November 2024 (16 days) - Days 213 down to 198
            '01NOV24': 213, '03NOV24': 212, '04NOV24': 211, '05NOV24': 210, '06NOV24': 209,
            '07NOV24': 208, '12NOV24': 207, '13NOV24': 206, '14NOV24': 205, '17NOV24': 204,
            '18NOV24': 203, '19NOV24': 202, '20NOV24': 201, '21NOV24': 200, '24NOV24': 199,
            '25NOV24': 198, '26NOV24': 197,
            // December 2025 (14 days) - Days 197 down to 184
            '01DEC25': 197, '02DEC25': 196, '03DEC25': 195, '04DEC25': 194, '08DEC25': 193,
            '09DEC25': 192, '10DEC25': 191, '11DEC25': 190, '12DEC25': 189, '15DEC25': 188,
            '16DEC25': 187, '17DEC25': 186, '18DEC25': 185, '19DEC25': 184,
            // Winter Break: 20DEC25 - 04JAN26 (NO PRODUCTION DAYS)
            // January 2026 (resumes after break) - Days 183 down to 165
            '05JAN26': 183, '06JAN26': 182, '07JAN26': 181, '08JAN26': 180, '09JAN26': 179,
            '12JAN26': 178, '13JAN26': 177, '14JAN26': 176, '15JAN26': 175, '16JAN26': 174,
            // MLK Day 19JAN26 is a holiday
            '20JAN26': 173, '21JAN26': 172, '22JAN26': 171, '23JAN26': 170, '26JAN26': 169,
            '27JAN26': 168, '28JAN26': 167, '29JAN26': 166, '30JAN26': 165,
            // January 2025 (19 days) - Days 183 down to 165
            '08JAN25': 183, '09JAN25': 182, '12JAN25': 181, '13JAN25': 180, '14JAN25': 179,
            '15JAN25': 178, '16JAN25': 177, '17JAN25': 176, '21JAN25': 175, '22JAN25': 174,
            '23JAN25': 173, '24JAN25': 172, '26JAN25': 171, '27JAN25': 170, '28JAN25': 169,
            '29JAN25': 168, '30JAN25': 167, '31JAN25': 166,
            // February 2025 (19 days) - Days 165 down to 147
            '02FEB25': 165, '03FEB25': 164, '04FEB25': 163, '05FEB25': 162, '06FEB25': 161,
            '09FEB25': 160, '10FEB25': 159, '11FEB25': 158, '12FEB25': 157, '13FEB25': 156,
            '17FEB25': 155, '18FEB25': 154, '19FEB25': 153, '20FEB25': 152, '23FEB25': 151,
            '24FEB25': 150, '25FEB25': 149, '26FEB25': 148, '27FEB25': 147,
            // March 2025 (21 days) - Days 146 down to 126
            '02MAR25': 146, '03MAR25': 145, '04MAR25': 144, '05MAR25': 143, '09MAR25': 142,
            '10MAR25': 141, '11MAR25': 140, '12MAR25': 139, '16MAR25': 138, '17MAR25': 137,
            '18MAR25': 136, '19MAR25': 135, '20MAR25': 134, '23MAR25': 133, '24MAR25': 132,
            '25MAR25': 131, '26MAR25': 130, '30MAR25': 129, '31MAR25': 128,
            // April 2025 (22 days) - Days 127 down to 106
            '01APR25': 127, '02APR25': 126, '06APR25': 125, '07APR25': 124, '08APR25': 123,
            '09APR25': 122, '10APR25': 121, '13APR25': 120, '14APR25': 119, '15APR25': 118,
            '16APR25': 117, '20APR25': 116, '21APR25': 115, '22APR25': 114, '23APR25': 113,
            '24APR25': 112, '27APR25': 111, '28APR25': 110, '29APR25': 109, '30APR25': 108
        };
        
        // Function to get production day from date string
        function getProductionDayFromDate(dateStr) {
            const lookup = dateStr.toUpperCase();
            if (PROD_DAY_SCHEDULE[lookup]) {
                return PROD_DAY_SCHEDULE[lookup];
            }
            // Fallback to calculation if date not in table
            const FY_START = new Date('2024-10-01');
            const day = parseInt(dateStr.substring(0, 2));
            const monthStr = dateStr.substring(2, 5).toUpperCase();
            const year = parseInt('20' + dateStr.substring(5, 7));
            const months = {'JAN':0,'FEB':1,'MAR':2,'APR':3,'MAY':4,'JUN':5,'JUL':6,'AUG':7,'SEP':8,'OCT':9,'NOV':10,'DEC':11};
            const currentDate = new Date(year, months[monthStr], day);
            const diffTime = currentDate - FY_START;
            return Math.max(1, 234 - Math.floor(diffTime / (1000 * 60 * 60 * 24)));
        }
        
        // Function to add production days (skipping weekends and holidays)
        function addProductionDays(startDateStr, daysToAdd) {
            const day = parseInt(startDateStr.substring(0, 2));
            const monthStr = startDateStr.substring(2, 5).toUpperCase();
            const year = parseInt('20' + startDateStr.substring(5, 7));
            const months = {'JAN':0,'FEB':1,'MAR':2,'APR':3,'MAY':4,'JUN':5,'JUL':6,'AUG':7,'SEP':8,'OCT':9,'NOV':10,'DEC':11};
            const monthNames = ['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC'];
            
            let currentDate = new Date(year, months[monthStr], day);
            let addedDays = 0;
            
            // FY26 holidays (non-production days)
            // Individual holidays
            const holidays = [
                '19JAN26'  // MLK Day (FY26 = 2026)
            ];
            
            // Winter break range: 20DEC25 - 04JAN26 (all non-production)
            const winterBreakStart = new Date(2025, 11, 20); // Dec 20, 2025
            const winterBreakEnd = new Date(2026, 0, 4);     // Jan 4, 2026
            
            while (addedDays < daysToAdd) {
                currentDate.setDate(currentDate.getDate() + 1);
                
                const dayOfWeek = currentDate.getDay(); // 0=Sunday, 6=Saturday
                const dateStr = String(currentDate.getDate()).padStart(2, '0') + 
                               monthNames[currentDate.getMonth()] + 
                               String(currentDate.getFullYear()).slice(-2);
                
                // Check if date is in winter break
                const inWinterBreak = currentDate >= winterBreakStart && currentDate <= winterBreakEnd;
                
                // Check if it's a production day (not weekend, not holiday, not winter break)
                if (dayOfWeek !== 0 && dayOfWeek !== 6 && !holidays.includes(dateStr) && !inWinterBreak) {
                    addedDays++;
                }
            }
            
            // Format result as DDMMMYY
            return String(currentDate.getDate()).padStart(2, '0') + 
                   monthNames[currentDate.getMonth()] + 
                   String(currentDate.getFullYear()).slice(-2);
        }
        
        // Function to get calendar date from production day number
        function getDateFromProductionDay(prodDay) {
            // Reverse lookup in the schedule
            for (const [date, day] of Object.entries(PROD_DAY_SCHEDULE)) {
                if (day === prodDay) {
                    return date;
                }
            }
            return `Day ${prodDay}`;  // Fallback if not found
        }
        
        // Modal elements
        const modalOverlay = document.getElementById('modalOverlay');
        const modalClose = document.getElementById('modalClose');
        const modalStationName = document.getElementById('modalStationName');
        const modalBadges = document.getElementById('modalBadges');
        const modalBody = document.getElementById('modalBody');
        
        const COLORS = {
            NAVY_DARK: '#0a1929',
            CARD_BG: '#1a2332',
            ZEUS_GOLD: '#ffd600',
            GOLD: '#FFB81C',
            POSEIDON_BLUE: '#2196f3',
            TRITON_TEAL: '#00acc1',
            WARRIOR_GREEN: '#00e676',
            DARK_GREEN: '#00c853',
            ACCENT_CYAN: '#00e5ff',
            WHITE: '#ffffff',
            LIGHT_GRAY: '#b0bec5'
        };
        
        // Drag and drop for current file
        uploadZone.addEventListener('click', () => fileInput.click());
        
        uploadZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadZone.classList.add('dragging');
        });
        
        uploadZone.addEventListener('dragleave', () => {
            uploadZone.classList.remove('dragging');
        });
        
        uploadZone.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadZone.classList.remove('dragging');
            const file = e.dataTransfer.files[0];
            if (file) handleFile(file);
        });
        
        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) handleFile(file);
        });
        
        // Drag and drop for previous file
        uploadZonePrevious.addEventListener('click', () => fileInputPrevious.click());
        
        uploadZonePrevious.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadZonePrevious.classList.add('dragging');
        });
        
        uploadZonePrevious.addEventListener('dragleave', () => {
            uploadZonePrevious.classList.remove('dragging');
        });
        
        uploadZonePrevious.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadZonePrevious.classList.remove('dragging');
            const file = e.dataTransfer.files[0];
            if (file) handlePreviousFile(file);
        });
        
        fileInputPrevious.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) handlePreviousFile(file);
        });
        
        function handleFile(file) {
            fileName.textContent = `üìÑ ${file.name}`;
            fileName.style.display = 'block';
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    if (!workbook.SheetNames.includes('Annual Goals & Attn')) {
                        showStatus('error', '‚ùå Sheet "Annual Goals & Attn" not found.');
                        return;
                    }
                    
                    const worksheet = workbook.Sheets['Annual Goals & Attn'];
                    excelData = XLSX.utils.sheet_to_json(worksheet);
                    
                    processData();
                    generateBtn.disabled = false;
                    showStatus('success', '‚úÖ Current week file loaded!');
                } catch (error) {
                    showStatus('error', `‚ùå Error: ${error.message}`);
                }
            };
            reader.readAsArrayBuffer(file);
        }
        
        function handlePreviousFile(file) {
            fileNamePrevious.textContent = `üìÑ ${file.name}`;
            fileNamePrevious.style.display = 'block';
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    if (!workbook.SheetNames.includes('Annual Goals & Attn')) {
                        showStatus('error', '‚ùå Previous week file: Sheet "Annual Goals & Attn" not found.');
                        return;
                    }
                    
                    const worksheet = workbook.Sheets['Annual Goals & Attn'];
                    previousExcelData = XLSX.utils.sheet_to_json(worksheet);
                    
                    if (excelData) {
                        processData();
                    }
                    
                    const numStations = previousExcelData.filter(r => r['STATIONS'] && r['STATIONS'].trim() !== '').length;
                    showStatus('success', `‚úÖ Previous week loaded (${numStations} stations)! Weekly Warriors will be calculated.`);
                } catch (error) {
                    showStatus('error', `‚ùå Error in previous file: ${error.message}`);
                }
            };
            reader.readAsArrayBuffer(file);
        }
        
        function showStatus(type, message) {
            statusMessage.className = `status ${type}`;
            statusMessage.textContent = message;
            statusMessage.style.display = 'block';
        }
        
        function processData() {
            const previousDataMap = {};
            if (previousExcelData) {
                previousExcelData
                    .filter(row => row['STATIONS'] && row['STATIONS'].trim() !== '')
                    .forEach(row => {
                        const stationName = (row['STATIONS'] || '').trim();
                        previousDataMap[stationName] = row['ALNAV GLIDESLOPE %'] || 0;
                    });
            }
            
            processedData = excelData
                .filter(row => row['STATIONS'] && row['STATIONS'].trim() !== '')
                .map(row => {
                const alnav = row['ALNAV GLIDESLOPE %'] || 0;
                const ac = row['AC GLIDESLOPE %'] || 0;
                const nso = row['NSO GLIDESLOPE %'] || 0;
                const nf = row['NUKE GLIDESLOPE %'] || 0;
                const stationName = (row['STATIONS'] || 'UNKNOWN').trim();
                
                let alnavChange = 0;
                if (previousDataMap[stationName] !== undefined) {
                    const previousAlnav = previousDataMap[stationName];
                    alnavChange = alnav - previousAlnav;
                }
                
                let tier = 'BELOW';
                let level = 0;
                let reward = '';
                
                if (alnav >= 1.40) {
                    tier = 'ZEUS';
                    if (ac >= 1.40 && nso >= 1.40 && nf >= 1.40) {
                        level = 3;
                        reward = 'Recurring 96-hour special liberty';
                    }
                    else if ((ac >= 1.0 ? 1 : 0) + (nso >= 1.0 ? 1 : 0) + (nf >= 1.0 ? 1 : 0) >= 2) {
                        level = 2;
                        reward = 'Recurring 72-hour special liberty';
                    }
                    else {
                        level = 1;
                        reward = '96-hour special liberty (one time per quarter)';
                    }
                } else if (alnav >= 1.20) {
                    tier = 'POSEIDON';
                    if (ac >= 1.20 && nso >= 1.20 && nf >= 1.20) {
                        level = 2;
                        reward = 'Recurring 72-hour special liberty';
                    }
                    else {
                        level = 1;
                        reward = '96-hour special liberty (one time per quarter)';
                    }
                } else if (alnav >= 1.00) {
                    tier = 'TRITON';
                    if (ac >= 1.0 && nso >= 1.0 && nf >= 1.0) {
                        level = 2;
                        reward = '1x 72-hour special liberty';
                    }
                    else {
                        level = 1;
                        reward = 'Polo Mondays';
                    }
                }
                
                return {
                    ...row,
                    STATIONS: stationName,
                    TIER: tier,
                    LEVEL: level,
                    REWARD: reward,
                    'ALNAV GLIDESLOPE %': alnav,
                    'AC GLIDESLOPE %': ac,
                    'NSO GLIDESLOPE %': nso,
                    'NF GLIDESLOPE %': nf,
                    ALNAV_CHANGE_PCT: alnavChange
                };
            });
            
            processedData.sort((a, b) => b['ALNAV GLIDESLOPE %'] - a['ALNAV GLIDESLOPE %']);
        }
        
        generateBtn.addEventListener('click', generateReport);
        
        function calculateNeeded(station) {
            const alnavPct = station['ALNAV GLIDESLOPE %'];
            const acPct = station['AC GLIDESLOPE %'];
            const nsoPct = station['NSO GLIDESLOPE %'];
            const nfPct = station['NF GLIDESLOPE %'];
            
            const acGoal = station['AC GOAL'] || 0;
            const nsoGoal = station['NSO GOAL'] || 0;
            const nfGoal = station['NUKE GOAL'] || 0;
            const alnavGoal = station['ALNAV GOAL'] || 0;
            
            const acAttn = station['AC ATTN'] || 0;
            const nsoAttn = station['NSO ATTN'] || 0;
            const nfAttn = station['NUKE ATTN'] || 0;
            const alnavAttn = station['ALNAV ATTN'] || 0;
            
            const nextDay = parseInt(nextProductionDay.value) || 38;
            const nextGlideslope = nextDay / 233;
            
            let parts = [];
            
            if (station.TIER === 'ZEUS') {
                if (station.LEVEL < 3) {
                    if (acPct < 1.40) {
                        const requiredByNext = Math.ceil(acGoal * nextGlideslope * 1.40);
                        const needed = requiredByNext - acAttn;
                        if (needed > 0) parts.push(`${needed} AC`);
                    }
                    if (nfPct < 1.40) {
                        const requiredByNext = Math.ceil(nfGoal * nextGlideslope * 1.40);
                        const needed = requiredByNext - nfAttn;
                        if (needed > 0) parts.push(`${needed} NF`);
                    }
                    if (nsoPct < 1.40) {
                        const requiredByNext = Math.ceil(nsoGoal * nextGlideslope * 1.40);
                        const needed = requiredByNext - nsoAttn;
                        if (needed > 0) parts.push(`${needed} NSO`);
                    }
                }
                if (parts.length > 0) {
                    return `For Level 3: ${parts.join(', ')} by day ${nextDay}`;
                }
            } else if (station.TIER === 'POSEIDON') {
                if (station.LEVEL < 2) {
                    if (acPct < 1.20) {
                        const requiredByNext = Math.ceil(acGoal * nextGlideslope * 1.20);
                        const needed = requiredByNext - acAttn;
                        if (needed > 0) parts.push(`${needed} AC`);
                    }
                    if (nfPct < 1.20) {
                        const requiredByNext = Math.ceil(nfGoal * nextGlideslope * 1.20);
                        const needed = requiredByNext - nfAttn;
                        if (needed > 0) parts.push(`${needed} NF`);
                    }
                    if (nsoPct < 1.20) {
                        const requiredByNext = Math.ceil(nsoGoal * nextGlideslope * 1.20);
                        const needed = requiredByNext - nsoAttn;
                        if (needed > 0) parts.push(`${needed} NSO`);
                    }
                }
                if (parts.length > 0) {
                    return `For Level 2: ${parts.join(', ')} by day ${nextDay}`;
                }
                
                // Check for Zeus
                if (alnavPct < 1.40) {
                    const requiredByNext = Math.ceil(alnavGoal * nextGlideslope * 1.40);
                    const needed = requiredByNext - alnavAttn;
                    if (needed > 0) return `For Zeus: ${needed} ALNAV by day ${nextDay}`;
                }
            } else if (station.TIER === 'TRITON') {
                if (station.LEVEL < 2) {
                    if (acPct < 1.0) {
                        const requiredByNext = Math.ceil(acGoal * nextGlideslope * 1.0);
                        const needed = requiredByNext - acAttn;
                        if (needed > 0) parts.push(`${needed} AC`);
                    }
                    if (nfPct < 1.0) {
                        const requiredByNext = Math.ceil(nfGoal * nextGlideslope * 1.0);
                        const needed = requiredByNext - nfAttn;
                        if (needed > 0) parts.push(`${needed} NF`);
                    }
                    if (nsoPct < 1.0) {
                        const requiredByNext = Math.ceil(nsoGoal * nextGlideslope * 1.0);
                        const needed = requiredByNext - nsoAttn;
                        if (needed > 0) parts.push(`${needed} NSO`);
                    }
                }
                if (parts.length > 0) {
                    return `For Level 2: ${parts.join(', ')} by day ${nextDay}`;
                }
                
                // Check for Poseidon
                if (alnavPct < 1.20) {
                    const requiredByNext = Math.ceil(alnavGoal * nextGlideslope * 1.20);
                    const needed = requiredByNext - alnavAttn;
                    if (needed > 0) return `For Poseidon: ${needed} ALNAV by day ${nextDay}`;
                }
            } else if (station.TIER === 'BELOW') {
                if (alnavPct < 1.00) {
                    const requiredByNext = Math.ceil(alnavGoal * nextGlideslope * 1.0);
                    const needed = requiredByNext - alnavAttn;
                    if (needed > 0) return `For Triton: ${needed} ALNAV by day ${nextDay}`;
                }
            }
            
            return '';
        }
        
        function generateReport() {
            stationClickMap = []; // Reset click map
            const canvasWidth = 1600;
            const canvasHeight = 2400;
            const scale = 3;
            
            reportCanvas.width = canvasWidth * scale;
            reportCanvas.height = canvasHeight * scale;
            reportCanvas.style.width = canvasWidth + 'px';
            reportCanvas.style.height = canvasHeight + 'px';
            
            const ctx = reportCanvas.getContext('2d');
            ctx.scale(scale, scale);
            
            // Navy textured background
            ctx.fillStyle = COLORS.NAVY_DARK;
            ctx.fillRect(0, 0, canvasWidth, canvasHeight);
            
            let y = 0;
            
            // Header
            y = drawHeaderOps(ctx, y, canvasWidth);
            y += 10;
            
            // Weekly Warriors
            y = drawWeeklyWarriorsOps(ctx, y, canvasWidth);
            y += 10;
            
            // Zeus Tier
            y = drawZeusTierOps(ctx, y, canvasWidth);
            y += 10;
            
            // Poseidon Tier
            y = drawPoseidonTierOps(ctx, y, canvasWidth);
            y += 10;
            
            // Triton Tier
            y = drawTritonTierOps(ctx, y, canvasWidth);
            y += 10;
            
            // On The Cusp
            y = drawOnTheCuspOps(ctx, y, canvasWidth);
            
            reportOutput.style.display = 'block';
            reportOutput.scrollIntoView({ behavior: 'smooth' });
        }
        
        function drawHeaderOps(ctx, startY, canvasWidth) {
            // Header bar
            ctx.fillStyle = COLORS.CARD_BG;
            ctx.fillRect(0, 0, canvasWidth, 80);
            
            ctx.fillStyle = COLORS.WHITE;
            ctx.font = 'bold 28px Helvetica, Arial, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('NTAG SOUTHWEST', canvasWidth / 2, 28);
            
            ctx.font = 'bold 24px Helvetica, Arial, sans-serif';
            ctx.fillText('WEEKLY NRS INCENTIVE EARNERS', canvasWidth / 2, 54);
            
            ctx.font = '16px Inter';
            ctx.fillStyle = COLORS.LIGHT_GRAY;
            ctx.fillText(`Cutoff ${currentReportDate.value.toUpperCase()}`, canvasWidth / 2, 72);
            
            // Pills on right - Days Remaining and Days Elapsed
            const calcDay = getProductionDayFromDate(currentReportDate.value);
            const daysRemaining = calcDay;
            const daysElapsed = 233 - calcDay;
            
            // Days Remaining pill (orange)
            ctx.fillStyle = COLORS.GOLD;
            roundRect(ctx, canvasWidth - 210, 18, 95, 24, 10, true);
            ctx.fillStyle = COLORS.NAVY_DARK;
            ctx.font = 'bold 11px Inter';
            ctx.textAlign = 'center';
            ctx.fillText(`${daysRemaining} DAYS LEFT`, canvasWidth - 162, 35);
            
            // Days Elapsed pill (cyan)
            ctx.fillStyle = COLORS.ACCENT_CYAN;
            roundRect(ctx, canvasWidth - 105, 18, 95, 24, 10, true);
            ctx.fillStyle = COLORS.NAVY_DARK;
            ctx.fillText(`${daysElapsed} DAYS IN`, canvasWidth - 57, 35);
            
            return 90;
        }
        
        function drawWeeklyWarriorsOps(ctx, startY, canvasWidth) {
            let y = startY;
            
            const warriors = processedData
                .filter(s => s.ALNAV_CHANGE_PCT && s.ALNAV_CHANGE_PCT > 0)
                .sort((a, b) => b.ALNAV_CHANGE_PCT - a.ALNAV_CHANGE_PCT)
                .slice(0, 5)
                .map(s => ({
                    name: s.STATIONS,
                    change: s.ALNAV_CHANGE_PCT * 100,
                    current: s['ALNAV GLIDESLOPE %'] * 100
                }));
            
            if (warriors.length === 0) return y;
            
            const gradient = ctx.createLinearGradient(50, y, canvasWidth - 50, y);
            gradient.addColorStop(0, COLORS.WARRIOR_GREEN);
            gradient.addColorStop(1, COLORS.DARK_GREEN);
            ctx.fillStyle = gradient;
            roundRect(ctx, 50, y, canvasWidth - 100, 35, 8, true);
            
            ctx.fillStyle = COLORS.WHITE;
            ctx.font = 'bold 21px Helvetica, Arial, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('üèÜ WEEKLY WARRIORS ‚Äì Top 5 Biggest Glideslope Improvements', canvasWidth / 2, y + 22);
            
            y += 45;
            
            warriors.forEach((w, i) => {
                ctx.fillStyle = COLORS.CARD_BG;
                roundRect(ctx, 60, y, canvasWidth - 120, 38, 8, true);
                ctx.shadowColor = 'rgba(0,0,0,0.3)';
                ctx.shadowBlur = 10;
                ctx.shadowOffsetY = 5;
                ctx.fillStyle = COLORS.CARD_BG;
                roundRect(ctx, 60, y, canvasWidth - 120, 38, 8, true);
                ctx.shadowBlur = 0;
                ctx.shadowOffsetY = 0;
                
                const medals = ['ü•á', 'ü•à', 'ü•â', '‚≠ê', '‚≠ê'];
                ctx.font = '26px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(medals[i], 80, y + 25);
                
                ctx.fillStyle = COLORS.WHITE;
                ctx.font = 'bold 17px Inter';
                ctx.fillText(`NRS ${w.name}`, 120, y + 20);
                
                ctx.fillStyle = COLORS.WARRIOR_GREEN;
                ctx.font = 'bold 26px Helvetica, Arial, sans-serif';
                ctx.textAlign = 'right';
                ctx.fillText(`+${w.change.toFixed(1)}%`, canvasWidth - 180, y + 24);
                
                ctx.font = '17px Inter';
                ctx.fillStyle = COLORS.LIGHT_GRAY;
                ctx.fillText(`now ${w.current.toFixed(1)}%`, canvasWidth - 80, y + 24);
                
                y += 45;
            });
            
            return y + 10;
        }
        
        function drawZeusTierOps(ctx, startY, canvasWidth) {
            let y = startY;
            
            const zeusStations = processedData.filter(s => s.TIER === 'ZEUS');
            if (zeusStations.length === 0) return y;
            
            const gradient = ctx.createLinearGradient(50, y, canvasWidth - 50, y);
            gradient.addColorStop(0, COLORS.ZEUS_GOLD);
            gradient.addColorStop(1, COLORS.GOLD);
            ctx.fillStyle = gradient;
            roundRect(ctx, 50, y, canvasWidth - 100, 38, 8, true);
            
            ctx.fillStyle = COLORS.NAVY_DARK;
            ctx.font = 'bold 26px Helvetica, Arial, sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText('‚ö° ZEUS TIER (‚â•140% ALNAV)', 80, y + 25);
            
            y += 35;
            
            y = drawTierCards(ctx, zeusStations, y, canvasWidth, COLORS.ZEUS_GOLD, 1);
            
            return y + 10;
        }
        
        function drawPoseidonTierOps(ctx, startY, canvasWidth) {
            let y = startY;
            
            const poseidonStations = processedData.filter(s => s.TIER === 'POSEIDON');
            if (poseidonStations.length === 0) return y;
            
            const zeusCount = processedData.filter(s => s.TIER === 'ZEUS').length;
            
            const gradient = ctx.createLinearGradient(50, y, canvasWidth - 50, y);
            gradient.addColorStop(0, COLORS.POSEIDON_BLUE);
            gradient.addColorStop(1, '#1565C0');
            ctx.fillStyle = gradient;
            roundRect(ctx, 50, y, canvasWidth - 100, 38, 8, true);
            
            ctx.fillStyle = COLORS.WHITE;
            ctx.font = 'bold 26px Helvetica, Arial, sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText('üî± POSEIDON TIER (‚â•120% ALNAV)', 80, y + 25);
            
            y += 35;
            
            y = drawTierCards(ctx, poseidonStations, y, canvasWidth, COLORS.POSEIDON_BLUE, zeusCount + 1);
            
            return y + 10;
        }
        
        function drawTritonTierOps(ctx, startY, canvasWidth) {
            let y = startY;
            
            const tritonStations = processedData.filter(s => s.TIER === 'TRITON');
            if (tritonStations.length === 0) return y;
            
            const aboveCount = processedData.filter(s => s.TIER === 'ZEUS' || s.TIER === 'POSEIDON').length;
            
            const gradient = ctx.createLinearGradient(50, y, canvasWidth - 50, y);
            gradient.addColorStop(0, COLORS.TRITON_TEAL);
            gradient.addColorStop(1, '#00838F');
            ctx.fillStyle = gradient;
            roundRect(ctx, 50, y, canvasWidth - 100, 38, 8, true);
            
            ctx.fillStyle = COLORS.WHITE;
            ctx.font = 'bold 26px Helvetica, Arial, sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText('üõ°Ô∏è TRITON TIER (‚â•100% ALNAV) - Polo Mondays', 80, y + 25);
            
            y += 35;
            
            y = drawTierCards(ctx, tritonStations, y, canvasWidth, COLORS.TRITON_TEAL, aboveCount + 1);
            
            return y + 10;
        }
        
        function drawOnTheCuspOps(ctx, startY, canvasWidth) {
            let y = startY;
            
            const belowStations = processedData.filter(s => s.TIER === 'BELOW' && s['ALNAV GLIDESLOPE %'] >= 0.75);
            if (belowStations.length === 0) return y;
            
            const aboveCount = processedData.filter(s => s.TIER !== 'BELOW').length;
            
            ctx.fillStyle = '#455a64';
            roundRect(ctx, 50, y, canvasWidth - 100, 50, 8, true);
            
            ctx.fillStyle = COLORS.WHITE;
            ctx.font = 'bold 26px Helvetica, Arial, sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText('‚ö†Ô∏è ON THE CUSP', 80, y + 20);
            
            ctx.font = '14px Helvetica, Arial, sans-serif';
            ctx.fillStyle = '#b0bec5';
            ctx.fillText('(for stations that are 75% ALNAV glideslope and greater)', 80, y + 40);
            
            y += 47;
            
            y = drawTierCards(ctx, belowStations, y, canvasWidth, '#757575', aboveCount + 1);
            return y;
        }
        
        function drawCategoryLeaders(ctx, startY, canvasWidth) {
            let y = startY;
            
            // Only show if we have historical data for comparison
            if (historicalWeeksData.length === 0) return y;
            
            // Header
            const gradient = ctx.createLinearGradient(50, y, canvasWidth - 50, y);
            gradient.addColorStop(0, '#00e676');
            gradient.addColorStop(1, '#00c853');
            ctx.fillStyle = gradient;
            roundRect(ctx, 50, y, canvasWidth - 100, 38, 8, true);
            
            ctx.fillStyle = COLORS.NAVY_DARK;
            ctx.font = 'bold 26px Helvetica, Arial, sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText('üöÄ BIGGEST MOVERS THIS WEEK', 80, y + 25);
            
            y += 48;
            
            // Find biggest week-over-week gainers in each category
            let alnavBiggest = { station: null, change: -999 };
            let acBiggest = { station: null, change: -999 };
            let nfBiggest = { station: null, change: -999 };
            let nsoBiggest = { station: null, change: -999 };
            
            processedData.forEach(station => {
                // ALNAV
                if (station.ALNAV_CHANGE_PCT > alnavBiggest.change) {
                    alnavBiggest = { 
                        station: station.STATIONS, 
                        change: station.ALNAV_CHANGE_PCT * 100,
                        current: station['ALNAV GLIDESLOPE %'] * 100
                    };
                }
                
                // AC
                const acChange = station['AC_CHANGE_PCT'] || 0;
                if (acChange > acBiggest.change) {
                    acBiggest = { 
                        station: station.STATIONS, 
                        change: acChange * 100,
                        current: station['AC GLIDESLOPE %'] * 100
                    };
                }
                
                // NF
                const nfChange = station['NF_CHANGE_PCT'] || 0;
                if (nfChange > nfBiggest.change) {
                    nfBiggest = { 
                        station: station.STATIONS, 
                        change: nfChange * 100,
                        current: station['NF GLIDESLOPE %'] * 100
                    };
                }
                
                // NSO
                const nsoChange = station['NSO_CHANGE_PCT'] || 0;
                if (nsoChange > nsoBiggest.change) {
                    nsoBiggest = { 
                        station: station.STATIONS, 
                        change: nsoChange * 100,
                        current: station['NSO GLIDESLOPE %'] * 100
                    };
                }
            });
            
            const movers = [
                { name: 'ALNAV', station: alnavBiggest.station, change: alnavBiggest.change, color: COLORS.GOLD },
                { name: 'AC', station: acBiggest.station, change: acBiggest.change, color: COLORS.POSEIDON_BLUE },
                { name: 'NF', station: nfBiggest.station, change: nfBiggest.change, color: COLORS.ZEUS_GOLD },
                { name: 'NSO', station: nsoBiggest.station, change: nsoBiggest.change, color: COLORS.WARRIOR_GREEN }
            ];
            
            // Draw 4 cards in a row
            const cardWidth = (canvasWidth - 140) / 4;
            const cardHeight = 80;
            const gap = 10;
            
            movers.forEach((mover, idx) => {
                const xPos = 60 + idx * (cardWidth + gap);
                
                // Card background
                ctx.shadowColor = 'rgba(0,0,0,0.4)';
                ctx.shadowBlur = 12;
                ctx.shadowOffsetY = 6;
                ctx.fillStyle = COLORS.CARD_BG;
                roundRect(ctx, xPos, y, cardWidth, cardHeight, 8, true);
                ctx.shadowBlur = 0;
                ctx.shadowOffsetY = 0;
                
                // Rocket icon
                ctx.fillStyle = mover.color;
                ctx.font = '24px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('üöÄ', xPos + cardWidth / 2, y + 25);
                
                // Category name
                ctx.fillStyle = mover.color;
                ctx.font = 'bold 14px Helvetica, Arial, sans-serif';
                ctx.fillText(mover.name, xPos + cardWidth / 2, y + 40);
                
                // Station name
                ctx.fillStyle = COLORS.WHITE;
                ctx.font = 'bold 11px Helvetica, Arial, sans-serif';
                const stationText = mover.station && mover.station.length > 15 ? mover.station.substring(0, 13) + '...' : (mover.station || 'N/A');
                ctx.fillText(stationText, xPos + cardWidth / 2, y + 55);
                
                // Change amount
                ctx.fillStyle = COLORS.WARRIOR_GREEN;
                ctx.font = 'bold 16px Helvetica, Arial, sans-serif';
                ctx.fillText(`+${mover.change.toFixed(1)}%`, xPos + cardWidth / 2, y + 72);
            });
            
            y += cardHeight + 20;
            
            return y;
        }
        
        function drawTierCards(ctx, stations, startY, canvasWidth, accentColor, startRank) {
            let y = startY;
            let rank = startRank;
            const cardWidth = (canvasWidth - 160) / 2;
            const cardHeight = 60;
            const gap = 3;
            
            stations.forEach((station, idx) => {
                const col = idx % 2;
                const xPos = 60 + col * (cardWidth + gap);
                
                if (col === 0 && idx > 0) y += cardHeight + gap;
                
                // Store click region for this station
                stationClickMap.push({
                    x: xPos,
                    y: y,
                    width: cardWidth,
                    height: cardHeight,
                    station: station
                });
                
                // Card background with shadow
                ctx.shadowColor = 'rgba(0,0,0,0.4)';
                ctx.shadowBlur = 12;
                ctx.shadowOffsetY = 6;
                ctx.fillStyle = COLORS.CARD_BG;
                roundRect(ctx, xPos, y, cardWidth, cardHeight, 8, true);
                ctx.shadowBlur = 0;
                ctx.shadowOffsetY = 0;
                
                // Rank circle
                ctx.fillStyle = accentColor;
                ctx.beginPath();
                ctx.arc(xPos + 22, y + 22, 16, 0, 2 * Math.PI);
                ctx.fill();
                
                ctx.fillStyle = COLORS.NAVY_DARK;
                ctx.font = 'bold 21px Inter';
                ctx.textAlign = 'center';
                ctx.fillText(rank.toString(), xPos + 22, y + 27);
                rank++;
                
                // NRS name
                ctx.fillStyle = COLORS.WHITE;
                ctx.font = 'bold 17px Inter';
                ctx.textAlign = 'left';
                ctx.fillText(`NRS ${station.STATIONS}`, xPos + 45, y + 20);
                
                // Calculate Hot Streak (consecutive weeks of improvement)
                let hotStreak = 0;
                let stationHistory = [];
                if (historicalWeeksData.length > 0) {
                    const parseDate = (dateStr) => {
                        const day = parseInt(dateStr.substring(0, 2));
                        const monthStr = dateStr.substring(2, 5).toUpperCase();
                        const year = parseInt('20' + dateStr.substring(5, 7));
                        const months = {'JAN':0,'FEB':1,'MAR':2,'APR':3,'MAY':4,'JUN':5,'JUL':6,'AUG':7,'SEP':8,'OCT':9,'NOV':10,'DEC':11};
                        return new Date(year, months[monthStr], day);
                    };
                    const sortedHistorical = [...historicalWeeksData].sort((a, b) => parseDate(a.date) - parseDate(b.date));
                    
                    sortedHistorical.forEach(week => {
                        const hist = week.stations.find(s => s.name === station.STATIONS);
                        if (hist) {
                            stationHistory.push(hist.alnav_glideslope_pct);
                        }
                    });
                    stationHistory.push(station['ALNAV GLIDESLOPE %']);
                    
                    // Count consecutive improvements from the end
                    for (let i = stationHistory.length - 1; i > 0; i--) {
                        if (stationHistory[i] > stationHistory[i-1]) {
                            hotStreak++;
                        } else {
                            break;
                        }
                    }
                }
                
                // Display Hot Streak with fire emojis
                if (hotStreak >= 2) {
                    const fireEmoji = 'üî•';
                    let fireDisplay = '';
                    if (hotStreak <= 5) {
                        fireDisplay = fireEmoji.repeat(hotStreak);
                    } else {
                        fireDisplay = `${fireEmoji}√ó${hotStreak}`;
                    }
                    
                    // Hot streak badge at BOTTOM RIGHT, lower position
                    const badgeX = xPos + cardWidth - 80;
                    const badgeY = y + cardHeight - 18;
                    
                    ctx.fillStyle = 'rgba(255, 69, 0, 0.9)';
                    roundRect(ctx, badgeX, badgeY, 75, 16, 8, true);
                    
                    ctx.fillStyle = '#FFFFFF';
                    ctx.font = 'bold 10px Helvetica, Arial, sans-serif';
                    ctx.textAlign = 'center';
                    ctx.fillText(`${fireDisplay} HOT`, badgeX + 37, badgeY + 11);
                }
                
                
                // ALNAV % - Large on right
                const pct = station['ALNAV GLIDESLOPE %'] * 100;
                ctx.fillStyle = pct >= 140 ? COLORS.ZEUS_GOLD : pct >= 120 ? COLORS.POSEIDON_BLUE : pct >= 100 ? COLORS.TRITON_TEAL : COLORS.LIGHT_GRAY;
                ctx.font = 'bold 24px Helvetica, Arial, sans-serif';
                ctx.textAlign = 'right';
                ctx.fillText(`${pct.toFixed(1)}%`, xPos + cardWidth - 12, y + 24);
                
                // Subgoal percentages
                const acPct = (station['AC GLIDESLOPE %'] * 100).toFixed(1);
                const nfPct = (station['NF GLIDESLOPE %'] * 100).toFixed(1);
                const nsoPct = (station['NSO GLIDESLOPE %'] * 100).toFixed(1);
                
                ctx.fillStyle = COLORS.LIGHT_GRAY;
                ctx.font = '15px Inter';  // Increased from 11px
                ctx.textAlign = 'left';
                ctx.fillText(`${acPct}% AC  |  ${nfPct}% NF  |  ${nsoPct}% NSO`, xPos + 45, y + 36);
                
                
                // Reward/Incentive text
                ctx.fillStyle = COLORS.ACCENT_CYAN;
                ctx.font = 'bold 13px Inter';
                ctx.textAlign = 'left';
                const rewardText = station.REWARD || '';
                const maxRewardLength = 65;
                const displayReward = rewardText.length > maxRewardLength ? rewardText.substring(0, maxRewardLength) + '...' : rewardText;
                ctx.fillText(displayReward, xPos + 45, y + 50);  // Fixed position, no sparkline offset
                
            });
            
            if (stations.length % 2 === 1) y += cardHeight + gap;
            
            return y + cardHeight - 15;  // Less space after last row
        }
        
        function roundRect(ctx, x, y, width, height, radius, fill) {
            ctx.beginPath();
            ctx.moveTo(x + radius, y);
            ctx.lineTo(x + width - radius, y);
            ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
            ctx.lineTo(x + width, y + height - radius);
            ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
            ctx.lineTo(x + radius, y + height);
            ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
            ctx.lineTo(x, y + radius);
            ctx.quadraticCurveTo(x, y, x + radius, y);
            ctx.closePath();
            if (fill) ctx.fill();
            else ctx.stroke();
        }
        
        // Click handler for canvas
        reportCanvas.addEventListener('click', (e) => {
            const rect = reportCanvas.getBoundingClientRect();
            const x = (e.clientX - rect.left) * (reportCanvas.width / rect.width) / 3; // Adjust for scale
            const y = (e.clientY - rect.top) * (reportCanvas.height / rect.height) / 3;
            
            // Check if click is within any station card
            for (const region of stationClickMap) {
                if (x >= region.x && x <= region.x + region.width &&
                    y >= region.y && y <= region.y + region.height) {
                    showStationModal(region.station);
                    break;
                }
            }
        });
        
        // Modal functions
        function showStationModal(station) {
            modalStationName.textContent = `NRS ${station.STATIONS}`;
            
            // Create tier badge
            let badgeHtml = '';
            if (station.TIER === 'ZEUS') {
                badgeHtml = `<span class="modal-tier-badge" style="background: ${COLORS.ZEUS_GOLD}; color: ${COLORS.NAVY_DARK};">‚ö° ZEUS TIER - Level ${station.LEVEL}</span>`;
            } else if (station.TIER === 'POSEIDON') {
                badgeHtml = `<span class="modal-tier-badge" style="background: ${COLORS.POSEIDON_BLUE}; color: white;">üî± POSEIDON TIER - Level ${station.LEVEL}</span>`;
            } else if (station.TIER === 'TRITON') {
                badgeHtml = `<span class="modal-tier-badge" style="background: ${COLORS.TRITON_TEAL}; color: white;">üõ°Ô∏è TRITON TIER - Level ${station.LEVEL}</span>`;
            } else {
                badgeHtml = `<span class="modal-tier-badge" style="background: #757575; color: white;">‚ö†Ô∏è ON THE CUSP</span>`;
            }
            
            if (station.REWARD) {
                badgeHtml += `<span class="modal-tier-badge" style="background: ${COLORS.ACCENT_CYAN}; color: ${COLORS.NAVY_DARK};">üéØ ${station.REWARD}</span>`;
            }
            
            modalBadges.innerHTML = badgeHtml;
            
            // Calculate future production days (5 and 10 days out)
            const currentDateStr = currentReportDate.value.toUpperCase();
            const nextDate = addProductionDays(currentDateStr, 5);
            const futureDate = addProductionDays(currentDateStr, 10);
            
            // Get production day numbers for calculations
            const currentDay = getProductionDayFromDate(currentDateStr);
            const nextDay = getProductionDayFromDate(nextDate);
            const futureDay = getProductionDayFromDate(futureDate);
            
            // Calculate rank change (if we have historical data)
            let rankChange = 0;
            let rankChangeText = 'N/A';
            let rankChangeColor = '#8b95a5';
            if (historicalWeeksData.length > 0) {
                // Get last week's data
                const parseDate = (dateStr) => {
                    const day = parseInt(dateStr.substring(0, 2));
                    const monthStr = dateStr.substring(2, 5).toUpperCase();
                    const year = parseInt('20' + dateStr.substring(5, 7));
                    const months = {'JAN':0,'FEB':1,'MAR':2,'APR':3,'MAY':4,'JUN':5,'JUL':6,'AUG':7,'SEP':8,'OCT':9,'NOV':10,'DEC':11};
                    return new Date(year, months[monthStr], day);
                };
                const sortedHistorical = [...historicalWeeksData].sort((a, b) => parseDate(a.date) - parseDate(b.date));
                const lastWeek = sortedHistorical[sortedHistorical.length - 1];
                
                if (lastWeek) {
                    // Sort last week's stations by glideslope to get rankings
                    const lastWeekSorted = [...lastWeek.stations].sort((a, b) => b.alnav_glideslope_pct - a.alnav_glideslope_pct);
                    const lastWeekRank = lastWeekSorted.findIndex(s => s.name === station.STATIONS) + 1;
                    
                    // Get current rank
                    const currentRank = processedData.findIndex(s => s.STATIONS === station.STATIONS) + 1;
                    
                    if (lastWeekRank > 0) {
                        rankChange = lastWeekRank - currentRank;
                        if (rankChange > 0) {
                            rankChangeText = `‚Üë ${rankChange}`;
                            rankChangeColor = COLORS.WARRIOR_GREEN;
                        } else if (rankChange < 0) {
                            rankChangeText = `‚Üì ${Math.abs(rankChange)}`;
                            rankChangeColor = '#ff5252';
                        } else {
                            rankChangeText = '‚Üí 0';
                            rankChangeColor = '#8b95a5';
                        }
                    }
                }
            }
            
            let modalContent = `
                <!-- Key Stats -->
                <div class="stat-grid">
                    <div class="stat-card">
                        <div class="stat-label">ALNAV Glideslope</div>
                        <div class="stat-value" style="color: ${station['ALNAV GLIDESLOPE %'] >= 1.4 ? COLORS.ZEUS_GOLD : station['ALNAV GLIDESLOPE %'] >= 1.2 ? COLORS.POSEIDON_BLUE : station['ALNAV GLIDESLOPE %'] >= 1.0 ? COLORS.TRITON_TEAL : COLORS.LIGHT_GRAY};">
                            ${(station['ALNAV GLIDESLOPE %'] * 100).toFixed(1)}%
                        </div>
                        <div class="stat-subtext">${station['ALNAV ATTN'] || 0} of ${station['ALNAV GOAL'] || 0} goal</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Current Rank</div>
                        <div class="stat-value">#${processedData.findIndex(s => s.STATIONS === station.STATIONS) + 1}</div>
                        <div class="stat-subtext">of ${processedData.length} stations</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Position vs Last Week</div>
                        <div class="stat-value" style="color: ${rankChangeColor}; font-size: 42px;">${rankChangeText}</div>
                        <div class="stat-subtext">${rankChange > 0 ? 'moved up' : rankChange < 0 ? 'moved down' : 'no change'}</div>
                    </div>
            `;
            
            if (station.ALNAV_CHANGE_PCT !== 0) {
                modalContent += `
                    <div class="stat-card">
                        <div class="stat-label">Week Change</div>
                        <div class="stat-value" style="color: ${station.ALNAV_CHANGE_PCT > 0 ? COLORS.WARRIOR_GREEN : '#ff5252'};">
                            ${station.ALNAV_CHANGE_PCT > 0 ? '+' : ''}${(station.ALNAV_CHANGE_PCT * 100).toFixed(1)}%
                        </div>
                        <div class="stat-subtext">since last report</div>
                    </div>
                `;
            }
            
            modalContent += `</div>`;
            
            // 8-Week Trend Line Chart (if historical data available)
            if (historicalWeeksData.length > 0) {
                const stationHistory = [];
                
                // Sort historical data by date (not week number which might be wrong)
                const sortedHistorical = [...historicalWeeksData].sort((a, b) => {
                    // Parse dates for comparison (DDMMMYY format)
                    const parseDate = (dateStr) => {
                        const day = parseInt(dateStr.substring(0, 2));
                        const monthStr = dateStr.substring(2, 5).toUpperCase();
                        const year = parseInt('20' + dateStr.substring(5, 7));
                        const months = {'JAN':0,'FEB':1,'MAR':2,'APR':3,'MAY':4,'JUN':5,'JUL':6,'AUG':7,'SEP':8,'OCT':9,'NOV':10,'DEC':11};
                        return new Date(year, months[monthStr], day);
                    };
                    return parseDate(a.date) - parseDate(b.date);
                });
                
                sortedHistorical.forEach(week => {
                    const hist = week.stations.find(s => s.name === station.STATIONS);
                    if (hist) {
                        stationHistory.push({
                            week: week.week,
                            date: week.date,
                            alnav_pct: hist.alnav_glideslope_pct  // Keep as decimal 0.167 = 16.7%
                        });
                    }
                });
                
                stationHistory.push({
                    week: stationHistory.length + 1,
                    date: currentReportDate.value,
                    alnav_pct: station['ALNAV GLIDESLOPE %']
                });
                
                // Sort by week number to ensure oldest (left) to newest (right)
                stationHistory.sort((a, b) => a.week - b.week);
                
                if (stationHistory.length >= 2) {
                    // Auto-scale based on data range
                    const dataValues = stationHistory.map(h => h.alnav_pct);
                    const minData = Math.min(...dataValues);
                    const maxData = Math.max(...dataValues);
                    const range = maxData - minData;
                    
                    // Add 20% padding above and below
                    const padding = range * 0.2;
                    const minPct = Math.max(0, minData - padding);
                    const maxPct = maxData + padding;
                    
                    const chartWidth = 600;
                    const chartHeight = 160;
                    const xStep = chartWidth / (stationHistory.length - 1);
                    
                    let pathData = '';
                    let pointsHTML = '';
                    
                    stationHistory.forEach((h, i) => {
                        const x = 50 + (i * xStep);
                        const pct = h.alnav_pct;
                        const normalizedPct = (pct - minPct) / (maxPct - minPct);
                        const y = 20 + (chartHeight - (normalizedPct * chartHeight));
                        
                        if (i === 0) pathData += `M${x},${y}`;
                        else pathData += ` L${x},${y}`;
                        
                        pointsHTML += `
                            <circle cx="${x}" cy="${y}" r="4" fill="${h.alnav_pct >= 1.0 ? '#00e676' : '#ff5252'}" stroke="#0a1929" stroke-width="2">
                                <title>${h.date}: ${(h.alnav_pct * 100).toFixed(1)}%</title>
                            </circle>
                            <text x="${x}" y="175" fill="#8b95a5" font-size="9" text-anchor="middle">${h.date}</text>
                        `;
                    });
                    
                    const lineColor = stationHistory[stationHistory.length - 1].alnav_pct >= 1.0 ? '#00e676' : '#ff5252';
                    
                    // Calculate Y-axis labels based on scale
                    const topLabel = (maxPct * 100).toFixed(0) + '%';
                    const mid1Label = ((minPct + (maxPct - minPct) * 0.75) * 100).toFixed(0) + '%';
                    const midLabel = ((minPct + (maxPct - minPct) * 0.5) * 100).toFixed(0) + '%';
                    const mid2Label = ((minPct + (maxPct - minPct) * 0.25) * 100).toFixed(0) + '%';
                    const bottomLabel = (minPct * 100).toFixed(0) + '%';
                    
                    // Draw 100% reference line if in range
                    let refLineHTML = '';
                    if (minPct <= 1.0 && maxPct >= 1.0) {
                        const refY = 20 + (chartHeight - ((1.0 - minPct) / (maxPct - minPct) * chartHeight));
                        refLineHTML = `<line x1="40" y1="${refY}" x2="100%" y2="${refY}" stroke="rgba(176, 190, 197, 0.5)" stroke-width="2" stroke-dasharray="5,5"/>`;
                    }
                    
                    modalContent += `
                        <div class="section-title">üìà ${stationHistory.length}-Week Performance Trend</div>
                        <div style="background: #0a1929; padding: 25px; border-radius: 12px; margin-bottom: 30px;">
                            <div style="position: relative; height: 180px;">
                                <svg width="100%" height="180" style="overflow: visible;">
                                    <line x1="40" y1="20" x2="100%" y2="20" stroke="rgba(176, 190, 197, 0.2)" stroke-width="1"/>
                                    <line x1="40" y1="60" x2="100%" y2="60" stroke="rgba(176, 190, 197, 0.2)" stroke-width="1"/>
                                    ${refLineHTML}
                                    <line x1="40" y1="140" x2="100%" y2="140" stroke="rgba(176, 190, 197, 0.2)" stroke-width="1"/>
                                    
                                    <text x="5" y="25" fill="#8b95a5" font-size="10">${topLabel}</text>
                                    <text x="5" y="65" fill="#8b95a5" font-size="10">${mid1Label}</text>
                                    <text x="5" y="105" fill="#8b95a5" font-size="10">${midLabel}</text>
                                    <text x="5" y="145" fill="#8b95a5" font-size="10">${bottomLabel}</text>
                                    
                                    <path d="${pathData}" stroke="${lineColor}" stroke-width="3" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                                    ${pointsHTML}
                                </svg>
                            </div>
                            <div style="text-align: center; color: #8b95a5; font-size: 12px; margin-top: 10px;">
                                ${stationHistory.length} weeks of data | Current: ${(station['ALNAV GLIDESLOPE %'] * 100).toFixed(1)}%
                            </div>
                        </div>
                    `;
                }
            }
            
            // Visual percentage bar chart
            modalContent += `
                <div class="section-title">üìä Glideslope Performance</div>
                <div style="background: #0a1929; padding: 30px; border-radius: 12px; margin-bottom: 30px;">
                    <div style="display: flex; justify-content: space-around; align-items: flex-end; height: 200px; position: relative;">
                        <!-- 100% reference line -->
                        <div style="position: absolute; left: 0; right: 0; top: 100px; border-top: 2px dashed rgba(176, 190, 197, 0.5); z-index: 1;">
                            <span style="position: absolute; right: 5px; top: -15px; color: #8b95a5; font-size: 11px; font-weight: 600;">100%</span>
                        </div>
                        
                        <!-- AC Bar -->
                        <div style="display: flex; flex-direction: column; align-items: center; z-index: 2;">
                            <div style="width: 60px; height: ${Math.min((station['AC GLIDESLOPE %'] * 100) / 200 * 200, 200)}px; background: ${station['AC GLIDESLOPE %'] >= 1.0 ? '#00e676' : '#ff5252'}; border-radius: 8px 8px 0 0; display: flex; align-items: flex-start; justify-content: center; padding-top: 8px;">
                                <span style="color: white; font-weight: 700; font-size: 21px;">${(station['AC GLIDESLOPE %'] * 100).toFixed(0)}%</span>
                            </div>
                            <div style="margin-top: 8px; color: white; font-weight: 600;">AC</div>
                        </div>
                        
                        <!-- NSO Bar -->
                        <div style="display: flex; flex-direction: column; align-items: center; z-index: 2;">
                            <div style="width: 60px; height: ${Math.min((station['NSO GLIDESLOPE %'] * 100) / 200 * 200, 200)}px; background: ${station['NSO GLIDESLOPE %'] >= 1.0 ? '#00e676' : '#ff5252'}; border-radius: 8px 8px 0 0; display: flex; align-items: flex-start; justify-content: center; padding-top: 8px;">
                                <span style="color: white; font-weight: 700; font-size: 21px;">${(station['NSO GLIDESLOPE %'] * 100).toFixed(0)}%</span>
                            </div>
                            <div style="margin-top: 8px; color: white; font-weight: 600;">NSO</div>
                        </div>
                        
                        <!-- NF Bar -->
                        <div style="display: flex; flex-direction: column; align-items: center; z-index: 2;">
                            <div style="width: 60px; height: ${Math.min((station['NF GLIDESLOPE %'] * 100) / 200 * 200, 200)}px; background: ${station['NF GLIDESLOPE %'] >= 1.0 ? '#00e676' : '#ff5252'}; border-radius: 8px 8px 0 0; display: flex; align-items: flex-start; justify-content: center; padding-top: 8px;">
                                <span style="color: white; font-weight: 700; font-size: 21px;">${(station['NF GLIDESLOPE %'] * 100).toFixed(0)}%</span>
                            </div>
                            <div style="margin-top: 8px; color: white; font-weight: 600;">NF</div>
                        </div>
                    </div>
                    <div style="text-align: center; color: #8b95a5; font-size: 12px; margin-top: 15px;">
                        Green = Above Glideslope (‚â•100%) | Red = Below Glideslope (&lt;100%)
                    </div>
                </div>
            `;
            
            // ALNAV Tier Progression - What's needed for next tier
            const currentALNAV = station['ALNAV GLIDESLOPE %'] * 100;
            const alnavGoal = station['ALNAV GOAL'] || 0;
            const alnavAttn = station['ALNAV ATTN'] || 0;
            
            let nextTier = '';
            let nextTierPercent = 0;
            let nextTierColor = '';
            
            if (currentALNAV < 100) {
                nextTier = 'üõ°Ô∏è TRITON (Glideslope)';
                nextTierPercent = 100;
                nextTierColor = COLORS.TRITON_TEAL;
            } else if (currentALNAV < 120) {
                nextTier = 'üî± POSEIDON';
                nextTierPercent = 120;
                nextTierColor = COLORS.POSEIDON_BLUE;
            } else if (currentALNAV < 140) {
                nextTier = '‚ö° ZEUS';
                nextTierPercent = 140;
                nextTierColor = COLORS.ZEUS_GOLD;
            } else {
                nextTier = '‚ö° ZEUS (Maintain)';
                nextTierPercent = 140;
                nextTierColor = COLORS.ZEUS_GOLD;
            }
            
            // Calculate what's needed for next tier (ALL stations including Zeus)
            // Convert production days (remaining/countdown) to days elapsed
            const daysElapsedNext = (233 - nextDay) + 1;
            const daysElapsedFuture = (233 - futureDay) + 1;
            
            // Calculate the TARGET (total contracts needed by that date)
            const targetNextDate = Math.ceil(alnavGoal * (daysElapsedNext / 233) * (nextTierPercent / 100));
            const targetFutureDate = Math.ceil(alnavGoal * (daysElapsedFuture / 233) * (nextTierPercent / 100));
            
            // Calculate how many MORE contracts still needed
            const neededNextDate = Math.max(0, targetNextDate - alnavAttn);
            const neededFutureDate = Math.max(0, targetFutureDate - alnavAttn);
            
            // If already there (needed = 0), show the target they've hit. Otherwise show what's still needed.
            const displayNextDate = neededNextDate === 0 ? targetNextDate : neededNextDate;
            const displayFutureDate = neededFutureDate === 0 ? targetFutureDate : neededFutureDate;
            
            // Calculate velocity (contracts per week over last 2 weeks)
            let weeklyVelocity = 0;
            if (historicalWeeksData.length >= 2) {
                const sortedHistorical = [...historicalWeeksData].sort((a, b) => {
                    const parseDate = (dateStr) => {
                        const day = parseInt(dateStr.substring(0, 2));
                        const monthStr = dateStr.substring(2, 5).toUpperCase();
                        const year = parseInt('20' + dateStr.substring(5, 7));
                        const months = {'JAN':0,'FEB':1,'MAR':2,'APR':3,'MAY':4,'JUN':5,'JUL':6,'AUG':7,'SEP':8,'OCT':9,'NOV':10,'DEC':11};
                        return new Date(year, months[monthStr], day);
                    };
                    return parseDate(a.date) - parseDate(b.date);
                });
                
                const twoWeeksAgo = sortedHistorical[sortedHistorical.length - 2];
                const oneWeekAgo = sortedHistorical[sortedHistorical.length - 1];
                
                const stationTwoWeeksAgo = twoWeeksAgo.stations.find(s => s.name === station.STATIONS);
                const stationOneWeekAgo = oneWeekAgo.stations.find(s => s.name === station.STATIONS);
                
                if (stationTwoWeeksAgo && stationOneWeekAgo) {
                    // Calculate ALNAV attainment increase per week
                    const attnTwoWeeksAgo = alnavGoal * stationTwoWeeksAgo.alnav_glideslope_pct;
                    const attnOneWeekAgo = alnavGoal * stationOneWeekAgo.alnav_glideslope_pct;
                    weeklyVelocity = (attnOneWeekAgo - attnTwoWeeksAgo);
                }
            }
            
            // Determine if "On Track" based on velocity
            // Assume ~2 weeks between reports (10 prod days)
            const projectedGain = weeklyVelocity * 2;
            const onTrackNext = neededNextDate === 0 || projectedGain >= neededNextDate;
            const onTrackFuture = neededFutureDate === 0 || projectedGain >= neededFutureDate;
            
            // Get tier name for label (without emoji)
            const tierLabel = nextTier.replace(/üõ°Ô∏è|üî±|‚ö°|‚úì/g, '').trim();
            
            modalContent += `
                <div class="section-title">üéØ ${currentALNAV >= 140 ? 'Maintain' : 'Next Goal'}: ${nextTier}</div>
                <div style="background: rgba(255,255,255,0.05); border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                    <div style="display: flex; gap: 15px; justify-content: space-around;">
                        <div style="flex: 1; background: ${neededNextDate === 0 ? 'rgba(0, 230, 118, 0.2)' : 'rgba(255, 82, 82, 0.2)'}; border-radius: 8px; padding: 15px; text-align: center; border: 2px solid ${neededNextDate === 0 ? '#00e676' : '#ff5252'};">
                            <div style="color: #8b95a5; font-size: 12px; margin-bottom: 8px;">By ${nextDate}</div>
                            <div style="color: ${nextTierColor}; font-size: 28px; font-weight: bold;">${displayNextDate}</div>
                            <div style="color: white; font-size: 13px; margin-top: 5px;">${neededNextDate === 0 ? '‚úì On Track for ' + tierLabel : 'contracts needed for ' + tierLabel}</div>
                        </div>
                        <div style="flex: 1; background: ${neededFutureDate === 0 ? 'rgba(0, 230, 118, 0.2)' : 'rgba(255, 82, 82, 0.2)'}; border-radius: 8px; padding: 15px; text-align: center; border: 2px solid ${neededFutureDate === 0 ? '#00e676' : '#ff5252'};">
                            <div style="color: #8b95a5; font-size: 12px; margin-bottom: 8px;">By ${futureDate}</div>
                            <div style="color: ${nextTierColor}; font-size: 28px; font-weight: bold;">${displayFutureDate}</div>
                            <div style="color: white; font-size: 13px; margin-top: 5px;">${neededFutureDate === 0 ? '‚úì On Track for ' + tierLabel : 'contracts needed for ' + tierLabel}</div>
                        </div>
                    </div>
                </div>
            `;
            
            // Historical Insights (if we have historical data)
            if (historicalWeeksData.length > 0) {
                const stationHistory = [];
                
                // Build history array
                const parseDate = (dateStr) => {
                    const day = parseInt(dateStr.substring(0, 2));
                    const monthStr = dateStr.substring(2, 5).toUpperCase();
                    const year = parseInt('20' + dateStr.substring(5, 7));
                    const months = {'JAN':0,'FEB':1,'MAR':2,'APR':3,'MAY':4,'JUN':5,'JUL':6,'AUG':7,'SEP':8,'OCT':9,'NOV':10,'DEC':11};
                    return new Date(year, months[monthStr], day);
                };
                const sortedHistorical = [...historicalWeeksData].sort((a, b) => parseDate(a.date) - parseDate(b.date));
                
                sortedHistorical.forEach(week => {
                    const hist = week.stations.find(s => s.name === station.STATIONS);
                    if (hist) {
                        stationHistory.push({
                            date: week.date,
                            pct: hist.alnav_glideslope_pct * 100
                        });
                    }
                });
                
                // Add current week
                stationHistory.push({
                    date: currentReportDate.value.toUpperCase(),
                    pct: station['ALNAV GLIDESLOPE %'] * 100
                });
                
                // Calculate insights
                let bestWeek = stationHistory[0];
                let sumPct = 0;
                let longestStreak = 0;
                let currentStreakCount = 0;
                
                stationHistory.forEach((week, i) => {
                    // Best week
                    if (week.pct > bestWeek.pct) {
                        bestWeek = week;
                    }
                    
                    // Average
                    sumPct += week.pct;
                    
                    // Longest streak
                    if (i > 0 && week.pct > stationHistory[i-1].pct) {
                        currentStreakCount++;
                        if (currentStreakCount > longestStreak) {
                            longestStreak = currentStreakCount;
                        }
                    } else {
                        currentStreakCount = 0;
                    }
                });
                
                const avgPct = sumPct / stationHistory.length;
                
                modalContent += `
                    <div class="section-title">üìä Historical Insights</div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px;">
                        <div style="background: rgba(255,255,255,0.05); border-radius: 12px; padding: 15px; text-align: center;">
                            <div style="color: #8b95a5; font-size: 12px; margin-bottom: 8px;">Best Week</div>
                            <div style="color: ${COLORS.WARRIOR_GREEN}; font-size: 28px; font-weight: bold;">${bestWeek.pct.toFixed(1)}%</div>
                            <div style="color: #8b95a5; font-size: 11px; margin-top: 5px;">${bestWeek.date}</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); border-radius: 12px; padding: 15px; text-align: center;">
                            <div style="color: #8b95a5; font-size: 12px; margin-bottom: 8px;">Longest Streak</div>
                            <div style="color: ${COLORS.GOLD}; font-size: 28px; font-weight: bold;">${longestStreak}</div>
                            <div style="color: #8b95a5; font-size: 11px; margin-top: 5px;">${longestStreak === 1 ? 'week' : 'weeks'} consecutive</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); border-radius: 12px; padding: 15px; text-align: center;">
                            <div style="color: #8b95a5; font-size: 12px; margin-bottom: 8px;">Average</div>
                            <div style="color: ${COLORS.ACCENT_CYAN}; font-size: 28px; font-weight: bold;">${avgPct.toFixed(1)}%</div>
                            <div style="color: #8b95a5; font-size: 11px; margin-top: 5px;">over ${stationHistory.length} weeks</div>
                        </div>
                    </div>
                `;
            }
            
            // Mission Areas Breakdown
            modalContent += `
                <div class="section-title">üìã Mission Areas Breakdown</div>
            `;
            
            const missions = [
                {
                    name: 'Active Component (AC)',
                    percent: station['AC GLIDESLOPE %'] * 100,
                    attn: station['AC ATTN'] || 0,
                    goal: station['AC GOAL'] || 0,
                    color: COLORS.POSEIDON_BLUE
                },
                {
                    name: 'Nuclear Field (NF)',
                    percent: station['NF GLIDESLOPE %'] * 100,
                    attn: station['NUKE ATTN'] || 0,
                    goal: station['NUKE GOAL'] || 0,
                    color: COLORS.ZEUS_GOLD
                },
                {
                    name: 'Navy Special Ops (NSO)',
                    percent: station['NSO GLIDESLOPE %'] * 100,
                    attn: station['NSO ATTN'] || 0,
                    goal: station['NSO GOAL'] || 0,
                    color: COLORS.WARRIOR_GREEN
                }
            ];
            
            missions.forEach(mission => {
                // Convert production days (remaining/countdown) to days elapsed for glideslope
                const nextGlideslope = ((233 - nextDay) + 1) / 233;
                const futureGlideslope = ((233 - futureDay) + 1) / 233;
                
                // Calculate targets and what's still needed
                const targetNext = Math.ceil(mission.goal * nextGlideslope);
                const targetFuture = Math.ceil(mission.goal * futureGlideslope);
                const neededNext = Math.max(0, targetNext - mission.attn);
                const neededFuture = Math.max(0, targetFuture - mission.attn);
                
                // Display target if on track, otherwise show what's needed
                const displayNext = neededNext === 0 ? targetNext : neededNext;
                const displayFuture = neededFuture === 0 ? targetFuture : neededFuture;
                
                modalContent += `
                    <div class="mission-area" style="border-left-color: ${mission.color};">
                        <div class="mission-header">
                            <div class="mission-name">${mission.name}</div>
                            <div class="mission-percent" style="color: ${mission.color};">${mission.percent.toFixed(1)}%</div>
                        </div>
                        <div class="mission-details">
                            <div class="mission-detail-item">
                                <div style="font-size: 11px;">Current</div>
                                <div class="mission-detail-value">${mission.attn} / ${mission.goal}</div>
                            </div>
                            <div class="mission-detail-item">
                                <div style="font-size: 11px;">${nextDate} Target</div>
                                <div class="mission-detail-value">${targetNext}</div>
                            </div>
                            <div class="mission-detail-item">
                                <div style="font-size: 11px;">${futureDate} Target</div>
                                <div class="mission-detail-value">${targetFuture}</div>
                            </div>
                        </div>
                        <div class="projection-timeline">
                            <div class="projection-card" style="background: ${neededNext === 0 ? 'rgba(0, 230, 118, 0.15)' : 'rgba(255, 82, 82, 0.15)'}; border: 2px solid ${neededNext === 0 ? '#00e676' : '#ff5252'};">
                                <div class="projection-day">By ${nextDate}</div>
                                <div class="projection-number" style="color: ${neededNext === 0 ? '#00e676' : '#ff5252'}; font-size: 24px; font-weight: bold; margin: 8px 0;">${displayNext}</div>
                                <div class="projection-target">${neededNext === 0 ? '‚úì On Track' : 'contracts needed'}</div>
                            </div>
                            <div class="projection-card" style="background: ${neededFuture === 0 ? 'rgba(0, 230, 118, 0.15)' : 'rgba(255, 82, 82, 0.15)'}; border: 2px solid ${neededFuture === 0 ? '#00e676' : '#ff5252'};">
                                <div class="projection-day">By ${futureDate}</div>
                                <div class="projection-number" style="color: ${neededFuture === 0 ? '#00e676' : '#ff5252'}; font-size: 24px; font-weight: bold; margin: 8px 0;">${displayFuture}</div>
                                <div class="projection-target">${neededFuture === 0 ? '‚úì On Track' : 'contracts needed'}</div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            // Tier Progression Path
            modalContent += `
                <div class="section-title">üéØ Tier Progression Path</div>
                <div class="tier-progression">
            `;
            
            // Zeus tiers
            const zeusL3Status = (station['ALNAV GLIDESLOPE %'] >= 1.4 && station['AC GLIDESLOPE %'] >= 1.4 && station['NSO GLIDESLOPE %'] >= 1.4 && station['NF GLIDESLOPE %'] >= 1.4) ? 'current' : 'locked';
            const zeusL2Status = (station['ALNAV GLIDESLOPE %'] >= 1.4 && (station['AC GLIDESLOPE %'] >= 1.0 ? 1 : 0) + (station['NSO GLIDESLOPE %'] >= 1.0 ? 1 : 0) + (station['NF GLIDESLOPE %'] >= 1.0 ? 1 : 0) >= 2) ? (zeusL3Status === 'current' ? 'locked' : 'current') : 'achievable';
            const zeusL1Status = station['ALNAV GLIDESLOPE %'] >= 1.4 ? (zeusL3Status === 'current' || zeusL2Status === 'current' ? 'locked' : 'current') : 'achievable';
            
            modalContent += `
                <div class="progression-item" style="border-left-color: ${COLORS.ZEUS_GOLD};">
                    <div class="progression-tier">
                        ‚ö° ZEUS TIER Level 3
                        <span class="progression-status status-${zeusL3Status}">${zeusL3Status.toUpperCase()}</span>
                    </div>
                    <div class="progression-requirements">
                        ‚â•140% ALNAV AND ‚â•140% AC, NSO, NF<br>
                        <strong>Reward:</strong> Recurring 96-hour special liberty
                    </div>
                </div>
                <div class="progression-item" style="border-left-color: ${COLORS.ZEUS_GOLD};">
                    <div class="progression-tier">
                        ‚ö° ZEUS TIER Level 2
                        <span class="progression-status status-${zeusL2Status}">${zeusL2Status.toUpperCase()}</span>
                    </div>
                    <div class="progression-requirements">
                        ‚â•140% ALNAV AND 2 of 3 subgoals ‚â•100%<br>
                        <strong>Reward:</strong> Recurring 72-hour special liberty
                    </div>
                </div>
                <div class="progression-item" style="border-left-color: ${COLORS.ZEUS_GOLD};">
                    <div class="progression-tier">
                        ‚ö° ZEUS TIER Level 1
                        <span class="progression-status status-${zeusL1Status}">${zeusL1Status.toUpperCase()}</span>
                    </div>
                    <div class="progression-requirements">
                        ‚â•140% ALNAV only<br>
                        <strong>Reward:</strong> 96-hour special liberty (one time per quarter)
                    </div>
                </div>
            `;
            
            // Poseidon tiers
            const posL2Status = (station['ALNAV GLIDESLOPE %'] >= 1.2 && station['AC GLIDESLOPE %'] >= 1.2 && station['NSO GLIDESLOPE %'] >= 1.2 && station['NF GLIDESLOPE %'] >= 1.2) ? 'current' : 'achievable';
            const posL1Status = station['ALNAV GLIDESLOPE %'] >= 1.2 ? (posL2Status === 'current' ? 'locked' : 'current') : 'achievable';
            
            modalContent += `
                <div class="progression-item" style="border-left-color: ${COLORS.POSEIDON_BLUE};">
                    <div class="progression-tier">
                        üî± POSEIDON TIER Level 2
                        <span class="progression-status status-${posL2Status}">${posL2Status.toUpperCase()}</span>
                    </div>
                    <div class="progression-requirements">
                        ‚â•120% ALNAV AND ‚â•120% AC, NSO, NF<br>
                        <strong>Reward:</strong> Recurring 72-hour special liberty
                    </div>
                </div>
                <div class="progression-item" style="border-left-color: ${COLORS.POSEIDON_BLUE};">
                    <div class="progression-tier">
                        üî± POSEIDON TIER Level 1
                        <span class="progression-status status-${posL1Status}">${posL1Status.toUpperCase()}</span>
                    </div>
                    <div class="progression-requirements">
                        ‚â•120% ALNAV only<br>
                        <strong>Reward:</strong> 96-hour special liberty (one time per quarter)
                    </div>
                </div>
            `;
            
            // Triton tiers
            const tritonL2Status = (station['ALNAV GLIDESLOPE %'] >= 1.0 && station['AC GLIDESLOPE %'] >= 1.0 && station['NSO GLIDESLOPE %'] >= 1.0 && station['NF GLIDESLOPE %'] >= 1.0) ? 'current' : 'achievable';
            const tritonL1Status = station['ALNAV GLIDESLOPE %'] >= 1.0 ? (tritonL2Status === 'current' ? 'locked' : 'current') : 'achievable';
            
            modalContent += `
                <div class="progression-item" style="border-left-color: ${COLORS.TRITON_TEAL};">
                    <div class="progression-tier">
                        üõ°Ô∏è TRITON TIER Level 2
                        <span class="progression-status status-${tritonL2Status}">${tritonL2Status.toUpperCase()}</span>
                    </div>
                    <div class="progression-requirements">
                        ‚â•100% ALNAV AND ‚â•100% AC, NSO, NF<br>
                        <strong>Reward:</strong> 1x 72-hour special liberty
                    </div>
                </div>
                <div class="progression-item" style="border-left-color: ${COLORS.TRITON_TEAL};">
                    <div class="progression-tier">
                        üõ°Ô∏è TRITON TIER Level 1
                        <span class="progression-status status-${tritonL1Status}">${tritonL1Status.toUpperCase()}</span>
                    </div>
                    <div class="progression-requirements">
                        ‚â•100% ALNAV only<br>
                        <strong>Reward:</strong> Polo Mondays
                    </div>
                </div>
            </div>
            `;
            
            modalBody.innerHTML = modalContent;
            modalOverlay.classList.add('active');
        }
        
        modalClose.addEventListener('click', () => {
            modalOverlay.classList.remove('active');
        });
        
        modalOverlay.addEventListener('click', (e) => {
            if (e.target === modalOverlay) {
                modalOverlay.classList.remove('active');
            }
        });
        
        // Download buttons
        downloadBtn.addEventListener('click', () => {
            const link = document.createElement('a');
            link.download = `ops_incentive_report_${currentReportDate.value}.png`;
            link.href = reportCanvas.toDataURL('image/png', 1.0);
            link.click();
        });
        
        downloadPdfBtn.addEventListener('click', () => {
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF({
                orientation: 'portrait',
                unit: 'in',
                format: 'letter'
            });
            
            const imgData = reportCanvas.toDataURL('image/png', 1.0);
            pdf.addImage(imgData, 'PNG', 0, 0, 8.5, 11);
            pdf.save(`ops_incentive_report_${currentReportDate.value}.pdf`);
        });
        
        exportDataBtn.addEventListener('click', () => {
            const dataToExport = JSON.stringify(processedData, null, 2);
            exportDataText.value = dataToExport;
            exportSection.style.display = 'block';
            exportSection.scrollIntoView({ behavior: 'smooth' });
            copyStatus.style.display = 'none';
        });
        
        exportHistoricalBtn.addEventListener('click', () => {
            if (processedData.length === 0) {
                alert('Please generate a report first');
                return;
            }
            
            // Determine week number (count from historical data if loaded, or start at 1)
            const weekNum = historicalWeeksData.length > 0 ? historicalWeeksData.length + 1 : 1;
            
            // Create historical format - just name and glideslope percentage
            const historicalWeek = {
                week: weekNum,
                production_day: parseInt(currentProductionDay.value),
                date: currentReportDate.value,
                stations: processedData.map(station => ({
                    name: station.STATIONS,
                    alnav_glideslope_pct: station['ALNAV GLIDESLOPE %']
                }))
            };
            
            historicalDataText.value = JSON.stringify(historicalWeek, null, 2);
            weekNumber.textContent = weekNum;
            historicalExportSection.style.display = 'block';
            historicalExportSection.scrollIntoView({ behavior: 'smooth' });
            copyHistoricalStatus.style.display = 'none';
        });
        
        copyHistoricalBtn.addEventListener('click', () => {
            historicalDataText.select();
            historicalDataText.setSelectionRange(0, 99999);
            document.execCommand('copy');
            copyHistoricalStatus.style.display = 'block';
            setTimeout(() => {
                copyHistoricalStatus.style.display = 'none';
            }, 3000);
        });
        
        loadHistoricalBtn.addEventListener('click', () => {
            try {
                const jsonData = historicalDataInput.value.trim();
                if (!jsonData) {
                    alert('Please paste historical data first');
                    return;
                }
                
                historicalWeeksData = JSON.parse(jsonData);
                historicalStatus.textContent = `‚úÖ Loaded ${historicalWeeksData.length} weeks`;
                historicalStatus.style.display = 'inline';
                
                console.log('Historical data loaded:', historicalWeeksData.length, 'weeks');
                
            } catch (e) {
                alert('Error parsing historical data. Please check the JSON format.');
                console.error(e);
            }
        });
        
        copyDataBtn.addEventListener('click', () => {
            exportDataText.select();
            exportDataText.setSelectionRange(0, 99999);
            document.execCommand('copy');
            copyStatus.style.display = 'block';
            setTimeout(() => {
                copyStatus.style.display = 'none';
            }, 3000);
        });
        
        // Auto-load report on page load
        window.addEventListener('DOMContentLoaded', () => {
            if (REPORT_DATA_CONFIG.stations && REPORT_DATA_CONFIG.stations.length > 0) {
                processedData = REPORT_DATA_CONFIG.stations;
                historicalWeeksData = REPORT_DATA_CONFIG.historicalWeeks || [];
                
                // Set the date
                currentReportDate.value = REPORT_DATA_CONFIG.reportDate;
                
                // Generate report
                const canvas = document.getElementById('reportCanvas');
                const ctx = canvas.getContext('2d');
                canvas.width = 1400;
                canvas.height = 5000;
                
                // Call main generation function
                generateReportOps();
            } else {
                alert('No report data found. Please paste your JSON into REPORT_DATA_CONFIG.');
            }
        });
    </script>
</body>
</html>
